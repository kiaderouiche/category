module     uussbb_diagramsh1l1
   use precision, only: ki
   use msamurai
   use uussbb_color, only: numcs
   use uussbb_kinematics
   use uussbb_model
   use uussbb_config, only: debug_nlo_diagrams, &
   &  inspect_nlo_diagram, include_eps_terms, include_eps2_terms
   use uussbb_d2h1l1, only: diagram2
   use uussbb_d27h1l1, only: diagram27
   use uussbb_d28h1l1, only: diagram28
   use uussbb_d29h1l1, only: diagram29
   use uussbb_d30h1l1, only: diagram30
   use uussbb_d31h1l1, only: diagram31
   use uussbb_d32h1l1, only: diagram32
   use uussbb_d33h1l1, only: diagram33
   use uussbb_d89h1l1, only: diagram89
   use uussbb_d90h1l1, only: diagram90
   use uussbb_d91h1l1, only: diagram91
   use uussbb_d92h1l1, only: diagram92
   use uussbb_d93h1l1, only: diagram93
   use uussbb_d94h1l1, only: diagram94
   use uussbb_d95h1l1, only: diagram95
   use uussbb_d96h1l1, only: diagram96
   use uussbb_d97h1l1, only: diagram97
   use uussbb_d98h1l1, only: diagram98
   use uussbb_d99h1l1, only: diagram99
   use uussbb_d100h1l1, only: diagram100
   use uussbb_d101h1l1, only: diagram101
   use uussbb_d102h1l1, only: diagram102
   use uussbb_d159h1l1, only: diagram159
   use uussbb_d160h1l1, only: diagram160
   use uussbb_d161h1l1, only: diagram161
   use uussbb_d162h1l1, only: diagram162
   use uussbb_d163h1l1, only: diagram163
   use uussbb_d164h1l1, only: diagram164
   use uussbb_d165h1l1, only: diagram165
   use uussbb_d166h1l1, only: diagram166
   use uussbb_d167h1l1, only: diagram167
   use uussbb_d168h1l1, only: diagram168
   use uussbb_d169h1l1, only: diagram169
   use uussbb_d170h1l1, only: diagram170
   use uussbb_d171h1l1, only: diagram171
   use uussbb_d172h1l1, only: diagram172
   use uussbb_d178h1l1, only: diagram178
   use uussbb_d3h1l1, only: diagram3
   use uussbb_d20h1l1, only: diagram20
   use uussbb_d21h1l1, only: diagram21
   use uussbb_d22h1l1, only: diagram22
   use uussbb_d23h1l1, only: diagram23
   use uussbb_d24h1l1, only: diagram24
   use uussbb_d25h1l1, only: diagram25
   use uussbb_d26h1l1, only: diagram26
   use uussbb_d103h1l1, only: diagram103
   use uussbb_d104h1l1, only: diagram104
   use uussbb_d105h1l1, only: diagram105
   use uussbb_d106h1l1, only: diagram106
   use uussbb_d107h1l1, only: diagram107
   use uussbb_d108h1l1, only: diagram108
   use uussbb_d109h1l1, only: diagram109
   use uussbb_d110h1l1, only: diagram110
   use uussbb_d111h1l1, only: diagram111
   use uussbb_d112h1l1, only: diagram112
   use uussbb_d113h1l1, only: diagram113
   use uussbb_d114h1l1, only: diagram114
   use uussbb_d115h1l1, only: diagram115
   use uussbb_d116h1l1, only: diagram116
   use uussbb_d131h1l1, only: diagram131
   use uussbb_d132h1l1, only: diagram132
   use uussbb_d133h1l1, only: diagram133
   use uussbb_d134h1l1, only: diagram134
   use uussbb_d135h1l1, only: diagram135
   use uussbb_d136h1l1, only: diagram136
   use uussbb_d137h1l1, only: diagram137
   use uussbb_d138h1l1, only: diagram138
   use uussbb_d139h1l1, only: diagram139
   use uussbb_d140h1l1, only: diagram140
   use uussbb_d141h1l1, only: diagram141
   use uussbb_d142h1l1, only: diagram142
   use uussbb_d143h1l1, only: diagram143
   use uussbb_d144h1l1, only: diagram144
   use uussbb_d174h1l1, only: diagram174
   use uussbb_d173h1l1, only: diagram173
   use uussbb_d176h1l1, only: diagram176
   use uussbb_d175h1l1, only: diagram175
   use uussbb_d1h1l1, only: diagram1
   use uussbb_d34h1l1, only: diagram34
   use uussbb_d35h1l1, only: diagram35
   use uussbb_d36h1l1, only: diagram36
   use uussbb_d37h1l1, only: diagram37
   use uussbb_d38h1l1, only: diagram38
   use uussbb_d39h1l1, only: diagram39
   use uussbb_d40h1l1, only: diagram40
   use uussbb_d117h1l1, only: diagram117
   use uussbb_d118h1l1, only: diagram118
   use uussbb_d119h1l1, only: diagram119
   use uussbb_d120h1l1, only: diagram120
   use uussbb_d121h1l1, only: diagram121
   use uussbb_d122h1l1, only: diagram122
   use uussbb_d123h1l1, only: diagram123
   use uussbb_d124h1l1, only: diagram124
   use uussbb_d125h1l1, only: diagram125
   use uussbb_d126h1l1, only: diagram126
   use uussbb_d127h1l1, only: diagram127
   use uussbb_d128h1l1, only: diagram128
   use uussbb_d129h1l1, only: diagram129
   use uussbb_d130h1l1, only: diagram130
   use uussbb_d145h1l1, only: diagram145
   use uussbb_d146h1l1, only: diagram146
   use uussbb_d147h1l1, only: diagram147
   use uussbb_d148h1l1, only: diagram148
   use uussbb_d149h1l1, only: diagram149
   use uussbb_d150h1l1, only: diagram150
   use uussbb_d151h1l1, only: diagram151
   use uussbb_d152h1l1, only: diagram152
   use uussbb_d153h1l1, only: diagram153
   use uussbb_d154h1l1, only: diagram154
   use uussbb_d155h1l1, only: diagram155
   use uussbb_d156h1l1, only: diagram156
   use uussbb_d157h1l1, only: diagram157
   use uussbb_d158h1l1, only: diagram158
   use uussbb_d177h1l1, only: diagram177
   use uussbb_d75h1l1, only: diagram75
   use uussbb_d76h1l1, only: diagram76
   use uussbb_d81h1l1, only: diagram81
   use uussbb_d82h1l1, only: diagram82
   use uussbb_d79h1l1, only: diagram79
   use uussbb_d80h1l1, only: diagram80
   use uussbb_d6h1l1, only: diagram6
   use uussbb_d63h1l1, only: diagram63
   use uussbb_d64h1l1, only: diagram64
   use uussbb_d239h1l1, only: diagram239
   use uussbb_d240h1l1, only: diagram240
   use uussbb_d241h1l1, only: diagram241
   use uussbb_d242h1l1, only: diagram242
   use uussbb_d247h1l1, only: diagram247
   use uussbb_d248h1l1, only: diagram248
   use uussbb_d249h1l1, only: diagram249
   use uussbb_d250h1l1, only: diagram250
   use uussbb_d4h1l1, only: diagram4
   use uussbb_d59h1l1, only: diagram59
   use uussbb_d60h1l1, only: diagram60
   use uussbb_d227h1l1, only: diagram227
   use uussbb_d228h1l1, only: diagram228
   use uussbb_d229h1l1, only: diagram229
   use uussbb_d230h1l1, only: diagram230
   use uussbb_d235h1l1, only: diagram235
   use uussbb_d236h1l1, only: diagram236
   use uussbb_d237h1l1, only: diagram237
   use uussbb_d238h1l1, only: diagram238
   use uussbb_d83h1l1, only: diagram83
   use uussbb_d84h1l1, only: diagram84
   use uussbb_d5h1l1, only: diagram5
   use uussbb_d61h1l1, only: diagram61
   use uussbb_d62h1l1, only: diagram62
   use uussbb_d231h1l1, only: diagram231
   use uussbb_d232h1l1, only: diagram232
   use uussbb_d233h1l1, only: diagram233
   use uussbb_d234h1l1, only: diagram234
   use uussbb_d243h1l1, only: diagram243
   use uussbb_d244h1l1, only: diagram244
   use uussbb_d245h1l1, only: diagram245
   use uussbb_d246h1l1, only: diagram246
   use uussbb_d77h1l1, only: diagram77
   use uussbb_d78h1l1, only: diagram78
   use uussbb_d67h1l1, only: diagram67
   use uussbb_d68h1l1, only: diagram68
   use uussbb_d87h1l1, only: diagram87
   use uussbb_d88h1l1, only: diagram88
   use uussbb_d85h1l1, only: diagram85
   use uussbb_d86h1l1, only: diagram86
   use uussbb_d65h1l1, only: diagram65
   use uussbb_d66h1l1, only: diagram66
   use uussbb_d71h1l1, only: diagram71
   use uussbb_d72h1l1, only: diagram72
   use uussbb_d7h1l1, only: diagram7
   use uussbb_d8h1l1, only: diagram8
   use uussbb_d9h1l1, only: diagram9
   use uussbb_d10h1l1, only: diagram10
   use uussbb_d11h1l1, only: diagram11
   use uussbb_d12h1l1, only: diagram12
   use uussbb_d13h1l1, only: diagram13
   use uussbb_d14h1l1, only: diagram14
   use uussbb_d15h1l1, only: diagram15
   use uussbb_d16h1l1, only: diagram16
   use uussbb_d17h1l1, only: diagram17
   use uussbb_d18h1l1, only: diagram18
   use uussbb_d19h1l1, only: diagram19
   use uussbb_d69h1l1, only: diagram69
   use uussbb_d70h1l1, only: diagram70
   use uussbb_d73h1l1, only: diagram73
   use uussbb_d74h1l1, only: diagram74
   use uussbb_d212h1l1, only: diagram212
   use uussbb_d207h1l1, only: diagram207
   use uussbb_d226h1l1, only: diagram226
   use uussbb_d217h1l1, only: diagram217
   use uussbb_d221h1l1, only: diagram221
   use uussbb_d209h1l1, only: diagram209
   use uussbb_d45h1l1, only: diagram45
   use uussbb_d46h1l1, only: diagram46
   use uussbb_d214h1l1, only: diagram214
   use uussbb_d208h1l1, only: diagram208
   use uussbb_d57h1l1, only: diagram57
   use uussbb_d58h1l1, only: diagram58
   use uussbb_d219h1l1, only: diagram219
   use uussbb_d210h1l1, only: diagram210
   use uussbb_d203h1l1, only: diagram203
   use uussbb_d216h1l1, only: diagram216
   use uussbb_d224h1l1, only: diagram224
   use uussbb_d205h1l1, only: diagram205
   use uussbb_d225h1l1, only: diagram225
   use uussbb_d213h1l1, only: diagram213
   use uussbb_d53h1l1, only: diagram53
   use uussbb_d54h1l1, only: diagram54
   use uussbb_d211h1l1, only: diagram211
   use uussbb_d55h1l1, only: diagram55
   use uussbb_d56h1l1, only: diagram56
   use uussbb_d47h1l1, only: diagram47
   use uussbb_d48h1l1, only: diagram48
   use uussbb_d220h1l1, only: diagram220
   use uussbb_d218h1l1, only: diagram218
   use uussbb_d223h1l1, only: diagram223
   use uussbb_d204h1l1, only: diagram204
   use uussbb_d51h1l1, only: diagram51
   use uussbb_d52h1l1, only: diagram52
   use uussbb_d41h1l1, only: diagram41
   use uussbb_d42h1l1, only: diagram42
   use uussbb_d206h1l1, only: diagram206
   use uussbb_d43h1l1, only: diagram43
   use uussbb_d44h1l1, only: diagram44
   use uussbb_d215h1l1, only: diagram215
   use uussbb_d222h1l1, only: diagram222
   use uussbb_d49h1l1, only: diagram49
   use uussbb_d50h1l1, only: diagram50
   use uussbb_d181h1l1, only: diagram181
   use uussbb_d194h1l1, only: diagram194
   use uussbb_d197h1l1, only: diagram197
   use uussbb_d179h1l1, only: diagram179
   use uussbb_d189h1l1, only: diagram189
   use uussbb_d192h1l1, only: diagram192
   use uussbb_d184h1l1, only: diagram184
   use uussbb_d198h1l1, only: diagram198
   use uussbb_d190h1l1, only: diagram190
   use uussbb_d183h1l1, only: diagram183
   use uussbb_d185h1l1, only: diagram185
   use uussbb_d180h1l1, only: diagram180
   use uussbb_d193h1l1, only: diagram193
   use uussbb_d199h1l1, only: diagram199
   use uussbb_d188h1l1, only: diagram188
   use uussbb_d186h1l1, only: diagram186
   use uussbb_d202h1l1, only: diagram202
   use uussbb_d191h1l1, only: diagram191
   use uussbb_d196h1l1, only: diagram196
   use uussbb_d187h1l1, only: diagram187
   use uussbb_d200h1l1, only: diagram200
   use uussbb_d182h1l1, only: diagram182
   use uussbb_d201h1l1, only: diagram201
   use uussbb_d195h1l1, only: diagram195
   use uussbb_d251h1l1, only: diagram251
   use uussbb_d256h1l1, only: diagram256
   use uussbb_d257h1l1, only: diagram257
   use uussbb_d253h1l1, only: diagram253
   use uussbb_d258h1l1, only: diagram258
   use uussbb_d254h1l1, only: diagram254
   use uussbb_d252h1l1, only: diagram252
   use uussbb_d255h1l1, only: diagram255
   use uussbb_diagramsh1l0, only: amplitudel0 => amplitude
   use uussbb_abbrevh1l1
   implicit none

   integer, parameter :: num_diagrams = 258
   integer, parameter :: num_topologies = 0 + 89 + 1

   ! amp0 is used to store the LO amplitude between the calls
   ! for one kinematics.
   complex(ki),  dimension(numcs) :: amp0
   integer, dimension(numcs) :: perm
   logical :: use_perm

   interface     samplitude
      ! module procedure samplitude_diagrams
      module procedure samplitude_topologies
   end interface samplitude

   private :: ccontract, amp0, perm, use_perm

contains

   subroutine     init_amplitudel0()
      implicit none
      amp0 = amplitudel0()
   end subroutine init_amplitudel0

   function     samplitude_diagrams(scale2,ok,opt_amp0,opt_perm) result(samplitude)
      implicit none
      double precision, intent(in) :: scale2
      logical, intent(out) :: ok
      complex(ki), dimension(numcs), intent(in), optional :: opt_amp0
      integer, dimension(numcs), intent(in), optional :: opt_perm
      real(ki), dimension(-2:0) :: samplitude

      integer :: nleg, rank
      complex(ki), dimension(-2:0) :: tot0, totx
      complex(ki) :: tot0r
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq
      logical :: my_ok

      ok = .true.

      if (present(opt_amp0)) then
         amp0 = opt_amp0
      else
         call init_amplitudel0()
      end if

      if (present(opt_perm)) then
         use_perm = .true.
         perm = opt_perm
      else
         use_perm = .false.
      end if
      
      call init_abbrev()
      samplitude(:) = 0.0_ki
      ! Topology 0
      call load_diagram(2, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 2
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d2e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d2e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d2e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 2, 1, 19)
      end if
      call load_diagram(27, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 27
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d27e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d27e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d27e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 27, 1, 19)
      end if
      call load_diagram(28, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 28
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d28e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d28e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d28e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 28, 1, 19)
      end if
      call load_diagram(29, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 29
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d29e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d29e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d29e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 29, 1, 19)
      end if
      call load_diagram(30, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 30
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d30e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d30e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d30e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 30, 1, 19)
      end if
      call load_diagram(31, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 31
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d31e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d31e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d31e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 31, 1, 19)
      end if
      call load_diagram(32, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 32
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d32e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d32e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d32e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 32, 1, 19)
      end if
      call load_diagram(33, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 33
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d33e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d33e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d33e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 33, 1, 19)
      end if
      call load_diagram(89, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 89
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d89e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d89e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d89e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 89, 1, 19)
      end if
      call load_diagram(90, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 90
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d90e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d90e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d90e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 90, 1, 19)
      end if
      call load_diagram(91, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 91
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d91e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d91e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d91e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 91, 1, 19)
      end if
      call load_diagram(92, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 92
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d92e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d92e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d92e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 92, 1, 19)
      end if
      call load_diagram(93, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 93
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d93e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d93e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d93e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 93, 1, 19)
      end if
      call load_diagram(94, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 94
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d94e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d94e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d94e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 94, 1, 19)
      end if
      call load_diagram(95, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 95
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d95e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d95e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d95e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 95, 1, 19)
      end if
      call load_diagram(96, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 96
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d96e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d96e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d96e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 96, 1, 19)
      end if
      call load_diagram(97, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 97
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d97e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d97e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d97e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 97, 1, 19)
      end if
      call load_diagram(98, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 98
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d98e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d98e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d98e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 98, 1, 19)
      end if
      call load_diagram(99, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 99
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d99e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d99e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d99e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 99, 1, 19)
      end if
      call load_diagram(100, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 100
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d100e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d100e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d100e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 100, 1, 19)
      end if
      call load_diagram(101, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 101
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d101e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d101e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d101e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 101, 1, 19)
      end if
      call load_diagram(102, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 102
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d102e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d102e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d102e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 102, 1, 19)
      end if
      call load_diagram(159, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 159
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d159e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d159e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d159e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 159, 1, 19)
      end if
      call load_diagram(160, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 160
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d160e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d160e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d160e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 160, 1, 19)
      end if
      call load_diagram(161, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 161
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d161e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d161e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d161e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 161, 1, 19)
      end if
      call load_diagram(162, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 162
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d162e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d162e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d162e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 162, 1, 19)
      end if
      call load_diagram(163, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 163
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d163e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d163e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d163e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 163, 1, 19)
      end if
      call load_diagram(164, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 164
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d164e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d164e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d164e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 164, 1, 19)
      end if
      call load_diagram(165, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 165
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d165e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d165e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d165e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 165, 1, 19)
      end if
      call load_diagram(166, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 166
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d166e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d166e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d166e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 166, 1, 19)
      end if
      call load_diagram(167, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 167
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d167e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d167e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d167e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 167, 1, 19)
      end if
      call load_diagram(168, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 168
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d168e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d168e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d168e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 168, 1, 19)
      end if
      call load_diagram(169, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 169
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d169e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d169e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d169e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 169, 1, 19)
      end if
      call load_diagram(170, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 170
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d170e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d170e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d170e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 170, 1, 19)
      end if
      call load_diagram(171, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 171
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d171e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d171e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d171e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 171, 1, 19)
      end if
      call load_diagram(172, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 172
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d172e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d172e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d172e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 172, 1, 19)
      end if
      ! Topology 1
      call load_diagram(178, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 178
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d178e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d178e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d178e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 178, 1, 19)
      end if
      ! Topology 2
      call load_diagram(3, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 3
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d3e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d3e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d3e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 3, 1, 19)
      end if
      call load_diagram(20, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 20
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d20e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d20e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d20e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 20, 1, 19)
      end if
      call load_diagram(21, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 21
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d21e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d21e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d21e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 21, 1, 19)
      end if
      call load_diagram(22, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 22
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d22e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d22e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d22e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 22, 1, 19)
      end if
      call load_diagram(23, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 23
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d23e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d23e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d23e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 23, 1, 19)
      end if
      call load_diagram(24, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 24
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d24e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d24e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d24e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 24, 1, 19)
      end if
      call load_diagram(25, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 25
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d25e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d25e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d25e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 25, 1, 19)
      end if
      call load_diagram(26, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 26
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d26e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d26e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d26e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 26, 1, 19)
      end if
      call load_diagram(103, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 103
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d103e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d103e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d103e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 103, 1, 19)
      end if
      call load_diagram(104, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 104
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d104e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d104e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d104e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 104, 1, 19)
      end if
      call load_diagram(105, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 105
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d105e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d105e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d105e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 105, 1, 19)
      end if
      call load_diagram(106, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 106
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d106e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d106e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d106e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 106, 1, 19)
      end if
      call load_diagram(107, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 107
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d107e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d107e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d107e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 107, 1, 19)
      end if
      call load_diagram(108, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 108
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d108e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d108e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d108e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 108, 1, 19)
      end if
      call load_diagram(109, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 109
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d109e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d109e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d109e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 109, 1, 19)
      end if
      call load_diagram(110, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 110
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d110e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d110e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d110e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 110, 1, 19)
      end if
      call load_diagram(111, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 111
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d111e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d111e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d111e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 111, 1, 19)
      end if
      call load_diagram(112, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 112
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d112e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d112e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d112e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 112, 1, 19)
      end if
      call load_diagram(113, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 113
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d113e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d113e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d113e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 113, 1, 19)
      end if
      call load_diagram(114, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 114
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d114e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d114e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d114e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 114, 1, 19)
      end if
      call load_diagram(115, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 115
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d115e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d115e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d115e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 115, 1, 19)
      end if
      call load_diagram(116, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 116
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d116e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d116e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d116e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 116, 1, 19)
      end if
      call load_diagram(131, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 131
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d131e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d131e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d131e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 131, 1, 19)
      end if
      call load_diagram(132, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 132
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d132e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d132e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d132e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 132, 1, 19)
      end if
      call load_diagram(133, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 133
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d133e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d133e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d133e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 133, 1, 19)
      end if
      call load_diagram(134, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 134
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d134e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d134e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d134e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 134, 1, 19)
      end if
      call load_diagram(135, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 135
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d135e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d135e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d135e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 135, 1, 19)
      end if
      call load_diagram(136, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 136
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d136e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d136e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d136e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 136, 1, 19)
      end if
      call load_diagram(137, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 137
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d137e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d137e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d137e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 137, 1, 19)
      end if
      call load_diagram(138, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 138
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d138e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d138e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d138e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 138, 1, 19)
      end if
      call load_diagram(139, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 139
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d139e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d139e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d139e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 139, 1, 19)
      end if
      call load_diagram(140, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 140
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d140e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d140e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d140e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 140, 1, 19)
      end if
      call load_diagram(141, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 141
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d141e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d141e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d141e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 141, 1, 19)
      end if
      call load_diagram(142, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 142
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d142e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d142e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d142e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 142, 1, 19)
      end if
      call load_diagram(143, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 143
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d143e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d143e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d143e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 143, 1, 19)
      end if
      call load_diagram(144, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 144
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d144e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d144e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d144e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 144, 1, 19)
      end if
      ! Topology 3
      call load_diagram(174, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 174
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d174e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d174e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d174e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 174, 1, 19)
      end if
      ! Topology 4
      call load_diagram(173, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 173
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d173e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d173e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d173e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 173, 1, 19)
      end if
      ! Topology 5
      call load_diagram(176, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 176
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d176e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d176e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d176e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 176, 1, 19)
      end if
      ! Topology 6
      call load_diagram(175, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 175
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d175e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d175e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d175e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 175, 1, 19)
      end if
      ! Topology 7
      call load_diagram(1, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 1
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d1e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d1e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d1e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 1, 1, 19)
      end if
      call load_diagram(34, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 34
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d34e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d34e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d34e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 34, 1, 19)
      end if
      call load_diagram(35, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 35
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d35e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d35e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d35e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 35, 1, 19)
      end if
      call load_diagram(36, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 36
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d36e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d36e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d36e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 36, 1, 19)
      end if
      call load_diagram(37, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 37
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d37e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d37e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d37e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 37, 1, 19)
      end if
      call load_diagram(38, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 38
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d38e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d38e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d38e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 38, 1, 19)
      end if
      call load_diagram(39, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 39
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d39e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d39e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d39e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 39, 1, 19)
      end if
      call load_diagram(40, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 40
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d40e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d40e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d40e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 40, 1, 19)
      end if
      call load_diagram(117, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 117
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d117e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d117e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d117e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 117, 1, 19)
      end if
      call load_diagram(118, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 118
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d118e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d118e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d118e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 118, 1, 19)
      end if
      call load_diagram(119, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 119
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d119e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d119e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d119e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 119, 1, 19)
      end if
      call load_diagram(120, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 120
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d120e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d120e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d120e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 120, 1, 19)
      end if
      call load_diagram(121, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 121
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d121e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d121e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d121e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 121, 1, 19)
      end if
      call load_diagram(122, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 122
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d122e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d122e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d122e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 122, 1, 19)
      end if
      call load_diagram(123, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 123
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d123e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d123e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d123e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 123, 1, 19)
      end if
      call load_diagram(124, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 124
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d124e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d124e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d124e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 124, 1, 19)
      end if
      call load_diagram(125, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 125
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d125e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d125e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d125e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 125, 1, 19)
      end if
      call load_diagram(126, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 126
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d126e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d126e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d126e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 126, 1, 19)
      end if
      call load_diagram(127, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 127
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d127e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d127e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d127e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 127, 1, 19)
      end if
      call load_diagram(128, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 128
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d128e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d128e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d128e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 128, 1, 19)
      end if
      call load_diagram(129, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 129
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d129e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d129e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d129e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 129, 1, 19)
      end if
      call load_diagram(130, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 130
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d130e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d130e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d130e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 130, 1, 19)
      end if
      call load_diagram(145, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 145
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d145e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d145e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d145e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 145, 1, 19)
      end if
      call load_diagram(146, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 146
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d146e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d146e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d146e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 146, 1, 19)
      end if
      call load_diagram(147, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 147
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d147e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d147e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d147e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 147, 1, 19)
      end if
      call load_diagram(148, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 148
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d148e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d148e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d148e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 148, 1, 19)
      end if
      call load_diagram(149, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 149
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d149e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d149e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d149e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 149, 1, 19)
      end if
      call load_diagram(150, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 150
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d150e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d150e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d150e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 150, 1, 19)
      end if
      call load_diagram(151, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 151
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d151e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d151e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d151e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 151, 1, 19)
      end if
      call load_diagram(152, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 152
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d152e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d152e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d152e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 152, 1, 19)
      end if
      call load_diagram(153, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 153
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d153e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d153e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d153e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 153, 1, 19)
      end if
      call load_diagram(154, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 154
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d154e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d154e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d154e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 154, 1, 19)
      end if
      call load_diagram(155, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 155
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d155e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d155e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d155e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 155, 1, 19)
      end if
      call load_diagram(156, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 156
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d156e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d156e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d156e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 156, 1, 19)
      end if
      call load_diagram(157, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 157
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d157e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d157e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d157e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 157, 1, 19)
      end if
      call load_diagram(158, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 158
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d158e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d158e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d158e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 158, 1, 19)
      end if
      ! Topology 8
      call load_diagram(177, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 177
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d177e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d177e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d177e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 177, 1, 19)
      end if
      ! Topology 9
      call load_diagram(75, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 75
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d75e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d75e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d75e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 75, 1, 19)
      end if
      call load_diagram(76, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 76
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d76e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d76e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d76e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 76, 1, 19)
      end if
      ! Topology 10
      call load_diagram(81, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 81
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d81e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d81e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d81e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 81, 1, 19)
      end if
      call load_diagram(82, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 82
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d82e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d82e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d82e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 82, 1, 19)
      end if
      ! Topology 11
      call load_diagram(79, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 79
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d79e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d79e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d79e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 79, 1, 19)
      end if
      call load_diagram(80, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 80
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d80e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d80e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d80e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 80, 1, 19)
      end if
      ! Topology 12
      call load_diagram(6, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 6
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d6e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d6e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d6e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 6, 1, 19)
      end if
      call load_diagram(63, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 63
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d63e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d63e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d63e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 63, 1, 19)
      end if
      call load_diagram(64, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 64
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d64e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d64e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d64e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 64, 1, 19)
      end if
      call load_diagram(239, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 239
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d239e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d239e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d239e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 239, 1, 19)
      end if
      call load_diagram(240, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 240
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d240e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d240e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d240e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 240, 1, 19)
      end if
      call load_diagram(241, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 241
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d241e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d241e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d241e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 241, 1, 19)
      end if
      call load_diagram(242, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 242
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d242e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d242e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d242e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 242, 1, 19)
      end if
      call load_diagram(247, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 247
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d247e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d247e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d247e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 247, 1, 19)
      end if
      call load_diagram(248, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 248
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d248e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d248e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d248e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 248, 1, 19)
      end if
      call load_diagram(249, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 249
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d249e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d249e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d249e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 249, 1, 19)
      end if
      call load_diagram(250, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 250
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d250e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d250e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d250e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 250, 1, 19)
      end if
      ! Topology 13
      call load_diagram(4, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 4
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d4e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d4e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d4e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 4, 1, 19)
      end if
      call load_diagram(59, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 59
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d59e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d59e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d59e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 59, 1, 19)
      end if
      call load_diagram(60, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 60
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d60e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d60e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d60e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 60, 1, 19)
      end if
      call load_diagram(227, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 227
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d227e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d227e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d227e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 227, 1, 19)
      end if
      call load_diagram(228, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 228
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d228e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d228e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d228e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 228, 1, 19)
      end if
      call load_diagram(229, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 229
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d229e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d229e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d229e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 229, 1, 19)
      end if
      call load_diagram(230, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 230
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d230e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d230e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d230e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 230, 1, 19)
      end if
      call load_diagram(235, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 235
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d235e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d235e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d235e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 235, 1, 19)
      end if
      call load_diagram(236, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 236
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d236e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d236e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d236e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 236, 1, 19)
      end if
      call load_diagram(237, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 237
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d237e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d237e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d237e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 237, 1, 19)
      end if
      call load_diagram(238, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 238
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d238e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d238e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d238e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 238, 1, 19)
      end if
      ! Topology 14
      call load_diagram(83, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 83
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d83e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d83e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d83e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 83, 1, 19)
      end if
      call load_diagram(84, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 84
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d84e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d84e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d84e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 84, 1, 19)
      end if
      ! Topology 15
      call load_diagram(5, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 5
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d5e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d5e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d5e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 5, 1, 19)
      end if
      call load_diagram(61, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 61
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d61e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d61e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d61e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 61, 1, 19)
      end if
      call load_diagram(62, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 62
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d62e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d62e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d62e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 62, 1, 19)
      end if
      call load_diagram(231, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 231
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d231e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d231e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d231e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 231, 1, 19)
      end if
      call load_diagram(232, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 232
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d232e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d232e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d232e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 232, 1, 19)
      end if
      call load_diagram(233, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 233
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d233e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d233e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d233e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 233, 1, 19)
      end if
      call load_diagram(234, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 234
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d234e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d234e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d234e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 234, 1, 19)
      end if
      call load_diagram(243, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 243
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d243e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d243e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d243e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 243, 1, 19)
      end if
      call load_diagram(244, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 244
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d244e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d244e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d244e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 244, 1, 19)
      end if
      call load_diagram(245, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 245
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d245e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d245e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d245e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 245, 1, 19)
      end if
      call load_diagram(246, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 246
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d246e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d246e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d246e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 246, 1, 19)
      end if
      ! Topology 16
      call load_diagram(77, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 77
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d77e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d77e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d77e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 77, 1, 19)
      end if
      call load_diagram(78, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 78
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d78e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d78e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d78e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 78, 1, 19)
      end if
      ! Topology 17
      call load_diagram(67, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 67
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d67e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d67e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d67e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 67, 1, 19)
      end if
      call load_diagram(68, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 68
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d68e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d68e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d68e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 68, 1, 19)
      end if
      ! Topology 18
      call load_diagram(87, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 87
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d87e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d87e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d87e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 87, 1, 19)
      end if
      call load_diagram(88, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 88
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d88e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d88e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d88e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 88, 1, 19)
      end if
      ! Topology 19
      call load_diagram(85, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 85
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d85e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d85e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d85e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 85, 1, 19)
      end if
      call load_diagram(86, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 86
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d86e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d86e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d86e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 86, 1, 19)
      end if
      ! Topology 20
      call load_diagram(65, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 65
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d65e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d65e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d65e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 65, 1, 19)
      end if
      call load_diagram(66, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 66
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d66e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d66e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d66e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 66, 1, 19)
      end if
      ! Topology 21
      call load_diagram(71, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 71
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d71e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d71e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d71e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 71, 1, 19)
      end if
      call load_diagram(72, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 72
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d72e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d72e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d72e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 72, 1, 19)
      end if
      ! Topology 22
      call load_diagram(7, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 7
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d7e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d7e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d7e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 7, 1, 19)
      end if
      call load_diagram(8, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 8
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d8e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d8e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d8e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 8, 1, 19)
      end if
      call load_diagram(9, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 9
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d9e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d9e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d9e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 9, 1, 19)
      end if
      call load_diagram(10, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 10
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d10e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d10e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d10e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 10, 1, 19)
      end if
      call load_diagram(11, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 11
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d11e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d11e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d11e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 11, 1, 19)
      end if
      call load_diagram(12, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 12
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d12e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d12e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d12e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 12, 1, 19)
      end if
      call load_diagram(13, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 13
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d13e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d13e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d13e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 13, 1, 19)
      end if
      call load_diagram(14, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 14
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d14e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d14e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d14e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 14, 1, 19)
      end if
      call load_diagram(15, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 15
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d15e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d15e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d15e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 15, 1, 19)
      end if
      call load_diagram(16, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 16
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d16e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d16e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d16e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 16, 1, 19)
      end if
      call load_diagram(17, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 17
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d17e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d17e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d17e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 17, 1, 19)
      end if
      call load_diagram(18, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 18
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d18e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d18e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d18e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 18, 1, 19)
      end if
      call load_diagram(19, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 19
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d19e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d19e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d19e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 19, 1, 19)
      end if
      ! Topology 23
      call load_diagram(69, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 69
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d69e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d69e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d69e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 69, 1, 19)
      end if
      call load_diagram(70, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 70
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d70e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d70e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d70e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 70, 1, 19)
      end if
      ! Topology 24
      call load_diagram(73, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 73
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d73e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d73e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d73e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 73, 1, 19)
      end if
      call load_diagram(74, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 74
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d74e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d74e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d74e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 74, 1, 19)
      end if
      ! Topology 25
      call load_diagram(212, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 212
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d212e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d212e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d212e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 212, 1, 19)
      end if
      ! Topology 26
      call load_diagram(207, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 207
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d207e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d207e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d207e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 207, 1, 19)
      end if
      ! Topology 27
      call load_diagram(226, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 226
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d226e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d226e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d226e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 226, 1, 19)
      end if
      ! Topology 28
      call load_diagram(217, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 217
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d217e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d217e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d217e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 217, 1, 19)
      end if
      ! Topology 29
      call load_diagram(221, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 221
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d221e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d221e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d221e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 221, 1, 19)
      end if
      ! Topology 30
      call load_diagram(209, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 209
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d209e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d209e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d209e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 209, 1, 19)
      end if
      ! Topology 31
      call load_diagram(45, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 45
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d45e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d45e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d45e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 45, 1, 19)
      end if
      call load_diagram(46, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 46
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d46e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d46e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d46e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 46, 1, 19)
      end if
      ! Topology 32
      call load_diagram(214, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 214
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d214e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d214e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d214e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 214, 1, 19)
      end if
      ! Topology 33
      call load_diagram(208, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 208
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d208e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d208e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d208e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 208, 1, 19)
      end if
      ! Topology 34
      call load_diagram(57, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 57
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d57e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d57e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d57e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 57, 1, 19)
      end if
      call load_diagram(58, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 58
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d58e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d58e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d58e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 58, 1, 19)
      end if
      ! Topology 35
      call load_diagram(219, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 219
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d219e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d219e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d219e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 219, 1, 19)
      end if
      ! Topology 36
      call load_diagram(210, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 210
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d210e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d210e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d210e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 210, 1, 19)
      end if
      ! Topology 37
      call load_diagram(203, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 203
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d203e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d203e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d203e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 203, 1, 19)
      end if
      ! Topology 38
      call load_diagram(216, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 216
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d216e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d216e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d216e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 216, 1, 19)
      end if
      ! Topology 39
      call load_diagram(224, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 224
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d224e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d224e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d224e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 224, 1, 19)
      end if
      ! Topology 40
      call load_diagram(205, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 205
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d205e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d205e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d205e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 205, 1, 19)
      end if
      ! Topology 41
      call load_diagram(225, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 225
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d225e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d225e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d225e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 225, 1, 19)
      end if
      ! Topology 42
      call load_diagram(213, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 213
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d213e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d213e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d213e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 213, 1, 19)
      end if
      ! Topology 43
      call load_diagram(53, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 53
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d53e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d53e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d53e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 53, 1, 19)
      end if
      call load_diagram(54, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 54
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d54e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d54e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d54e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 54, 1, 19)
      end if
      ! Topology 44
      call load_diagram(211, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 211
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d211e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d211e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d211e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 211, 1, 19)
      end if
      ! Topology 45
      call load_diagram(55, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 55
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d55e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d55e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d55e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 55, 1, 19)
      end if
      call load_diagram(56, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 56
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d56e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d56e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d56e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 56, 1, 19)
      end if
      ! Topology 46
      call load_diagram(47, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 47
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d47e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d47e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d47e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 47, 1, 19)
      end if
      call load_diagram(48, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 48
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d48e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d48e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d48e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 48, 1, 19)
      end if
      ! Topology 47
      call load_diagram(220, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 220
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d220e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d220e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d220e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 220, 1, 19)
      end if
      ! Topology 48
      call load_diagram(218, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 218
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d218e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d218e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d218e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 218, 1, 19)
      end if
      ! Topology 49
      call load_diagram(223, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 223
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d223e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d223e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d223e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 223, 1, 19)
      end if
      ! Topology 50
      call load_diagram(204, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 204
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d204e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d204e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d204e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 204, 1, 19)
      end if
      ! Topology 51
      call load_diagram(51, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 51
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d51e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d51e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d51e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 51, 1, 19)
      end if
      call load_diagram(52, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 52
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d52e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d52e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d52e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 52, 1, 19)
      end if
      ! Topology 52
      call load_diagram(41, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 41
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d41e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d41e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d41e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 41, 1, 19)
      end if
      call load_diagram(42, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 42
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d42e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d42e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d42e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 42, 1, 19)
      end if
      ! Topology 53
      call load_diagram(206, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 206
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d206e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d206e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d206e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 206, 1, 19)
      end if
      ! Topology 54
      call load_diagram(43, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 43
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d43e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d43e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d43e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 43, 1, 19)
      end if
      call load_diagram(44, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 44
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d44e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d44e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d44e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 44, 1, 19)
      end if
      ! Topology 55
      call load_diagram(215, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 215
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d215e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d215e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d215e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 215, 1, 19)
      end if
      ! Topology 56
      call load_diagram(222, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 222
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d222e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d222e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d222e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 222, 1, 19)
      end if
      ! Topology 57
      call load_diagram(49, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 49
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d49e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d49e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d49e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 49, 1, 19)
      end if
      call load_diagram(50, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 50
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d50e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d50e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d50e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 50, 1, 19)
      end if
      ! Topology 58
      call load_diagram(181, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 181
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d181e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d181e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d181e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 181, 1, 19)
      end if
      ! Topology 59
      call load_diagram(194, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 194
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d194e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d194e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d194e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 194, 1, 19)
      end if
      ! Topology 60
      call load_diagram(197, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 197
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d197e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d197e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d197e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 197, 1, 19)
      end if
      ! Topology 61
      call load_diagram(179, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 179
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d179e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d179e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d179e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 179, 1, 19)
      end if
      ! Topology 62
      call load_diagram(189, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 189
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d189e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d189e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d189e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 189, 1, 19)
      end if
      ! Topology 63
      call load_diagram(192, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 192
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d192e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d192e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d192e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 192, 1, 19)
      end if
      ! Topology 64
      call load_diagram(184, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 184
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d184e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d184e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d184e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 184, 1, 19)
      end if
      ! Topology 65
      call load_diagram(198, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 198
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d198e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d198e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d198e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 198, 1, 19)
      end if
      ! Topology 66
      call load_diagram(190, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 190
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d190e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d190e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d190e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 190, 1, 19)
      end if
      ! Topology 67
      call load_diagram(183, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 183
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d183e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d183e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d183e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 183, 1, 19)
      end if
      ! Topology 68
      call load_diagram(185, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 185
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d185e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d185e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d185e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 185, 1, 19)
      end if
      ! Topology 69
      call load_diagram(180, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 180
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d180e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d180e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d180e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 180, 1, 19)
      end if
      ! Topology 70
      call load_diagram(193, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 193
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d193e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d193e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d193e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 193, 1, 19)
      end if
      ! Topology 71
      call load_diagram(199, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 199
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d199e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d199e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d199e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 199, 1, 19)
      end if
      ! Topology 72
      call load_diagram(188, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 188
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d188e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d188e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d188e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 188, 1, 19)
      end if
      ! Topology 73
      call load_diagram(186, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 186
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d186e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d186e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d186e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 186, 1, 19)
      end if
      ! Topology 74
      call load_diagram(202, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 202
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d202e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d202e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d202e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 202, 1, 19)
      end if
      ! Topology 75
      call load_diagram(191, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 191
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d191e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d191e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d191e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 191, 1, 19)
      end if
      ! Topology 76
      call load_diagram(196, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 196
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d196e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d196e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d196e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 196, 1, 19)
      end if
      ! Topology 77
      call load_diagram(187, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 187
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d187e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d187e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d187e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 187, 1, 19)
      end if
      ! Topology 78
      call load_diagram(200, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 200
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d200e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d200e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d200e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 200, 1, 19)
      end if
      ! Topology 79
      call load_diagram(182, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 182
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d182e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d182e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d182e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 182, 1, 19)
      end if
      ! Topology 80
      call load_diagram(201, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 201
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d201e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d201e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d201e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 201, 1, 19)
      end if
      ! Topology 81
      call load_diagram(195, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 195
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d195e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d195e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d195e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 195, 1, 19)
      end if
      ! Topology 82
      call load_diagram(251, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 251
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d251e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d251e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d251e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 251, 1, 19)
      end if
      ! Topology 83
      call load_diagram(256, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 256
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d256e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d256e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d256e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 256, 1, 19)
      end if
      ! Topology 84
      call load_diagram(257, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 257
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d257e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d257e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d257e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 257, 1, 19)
      end if
      ! Topology 85
      call load_diagram(253, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 253
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d253e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d253e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d253e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 253, 1, 19)
      end if
      ! Topology 86
      call load_diagram(258, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 258
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d258e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d258e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d258e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 258, 1, 19)
      end if
      ! Topology 87
      call load_diagram(254, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 254
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d254e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d254e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d254e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 254, 1, 19)
      end if
      ! Topology 88
      call load_diagram(252, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 252
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d252e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d252e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d252e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 252, 1, 19)
      end if
      ! Topology 89
      call load_diagram(255, nleg, Vi, msq, rank)

      if(debug_nlo_diagrams) then
         write(19,'(A10,1x,I6)') "# Diagram:", 255
      end if

      tot0(:) = 0.0_ki
      call samurai(numerator_d255e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d255e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot1:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
            write(19,'(A15,2(1x,G24.16))') "#  single pole:", totx(-1)
         end if
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_d255e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
         if(debug_nlo_diagrams) then
            write(19,'(A21)') "#  contribution tot2:"
            write(19,'(A15,2(1x,G24.16))') "#  double pole:", totx(-2)
         end if
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)

      if(debug_nlo_diagrams) then
         call inspect_nlo_diagram(tot0, 255, 1, 19)
      end if
   end function samplitude_diagrams

   function     samplitude_topologies(scale2, ok, opt_amp0, opt_perm) result(samplitude)
      implicit none
      double precision, intent(in) :: scale2
      logical, intent(out) :: ok
      complex(ki), dimension(numcs), intent(in), optional :: opt_amp0
      integer, dimension(numcs), intent(in), optional :: opt_perm
      real(ki), dimension(-2:0) :: samplitude

      integer :: nleg, rank
      complex(ki), dimension(-2:0) :: tot0, totx
      complex(ki) :: tot0r
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq
      logical :: my_ok

      ok = .true.

      if (present(opt_amp0)) then
         amp0 = opt_amp0
      else
         call init_amplitudel0()
      end if

      if (present(opt_perm)) then
         use_perm = .true.
         perm = opt_perm
      else
         use_perm = .false.
      end if
      
      call init_abbrev()
      samplitude(:) = 0.0_ki
      ! Topology 0
      call load_topology(0, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t0e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t0e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t0e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 1
      call load_topology(1, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t1e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t1e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t1e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 2
      call load_topology(2, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t2e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t2e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t2e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 3
      call load_topology(3, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t3e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t3e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t3e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 4
      call load_topology(4, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t4e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t4e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t4e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 5
      call load_topology(5, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t5e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t5e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t5e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 6
      call load_topology(6, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t6e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t6e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t6e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 7
      call load_topology(7, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t7e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t7e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t7e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 8
      call load_topology(8, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t8e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t8e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t8e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 9
      call load_topology(9, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t9e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t9e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t9e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 10
      call load_topology(10, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t10e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t10e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t10e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 11
      call load_topology(11, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t11e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t11e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t11e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 12
      call load_topology(12, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t12e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t12e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t12e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 13
      call load_topology(13, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t13e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t13e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t13e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 14
      call load_topology(14, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t14e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t14e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t14e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 15
      call load_topology(15, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t15e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t15e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t15e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 16
      call load_topology(16, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t16e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t16e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t16e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 17
      call load_topology(17, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t17e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t17e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t17e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 18
      call load_topology(18, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t18e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t18e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t18e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 19
      call load_topology(19, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t19e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t19e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t19e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 20
      call load_topology(20, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t20e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t20e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t20e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 21
      call load_topology(21, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t21e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t21e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t21e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 22
      call load_topology(22, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t22e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t22e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t22e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 23
      call load_topology(23, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t23e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t23e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t23e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 24
      call load_topology(24, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t24e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t24e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t24e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 25
      call load_topology(25, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t25e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t25e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t25e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 26
      call load_topology(26, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t26e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t26e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t26e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 27
      call load_topology(27, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t27e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t27e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t27e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 28
      call load_topology(28, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t28e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t28e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t28e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 29
      call load_topology(29, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t29e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t29e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t29e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 30
      call load_topology(30, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t30e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t30e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t30e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 31
      call load_topology(31, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t31e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t31e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t31e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 32
      call load_topology(32, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t32e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t32e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t32e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 33
      call load_topology(33, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t33e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t33e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t33e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 34
      call load_topology(34, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t34e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t34e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t34e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 35
      call load_topology(35, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t35e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t35e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t35e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 36
      call load_topology(36, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t36e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t36e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t36e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 37
      call load_topology(37, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t37e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t37e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t37e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 38
      call load_topology(38, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t38e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t38e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t38e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 39
      call load_topology(39, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t39e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t39e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t39e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 40
      call load_topology(40, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t40e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t40e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t40e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 41
      call load_topology(41, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t41e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t41e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t41e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 42
      call load_topology(42, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t42e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t42e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t42e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 43
      call load_topology(43, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t43e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t43e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t43e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 44
      call load_topology(44, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t44e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t44e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t44e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 45
      call load_topology(45, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t45e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t45e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t45e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 46
      call load_topology(46, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t46e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t46e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t46e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 47
      call load_topology(47, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t47e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t47e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t47e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 48
      call load_topology(48, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t48e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t48e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t48e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 49
      call load_topology(49, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t49e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t49e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t49e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 50
      call load_topology(50, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t50e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t50e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t50e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 51
      call load_topology(51, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t51e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t51e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t51e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 52
      call load_topology(52, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t52e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t52e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t52e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 53
      call load_topology(53, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t53e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t53e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t53e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 54
      call load_topology(54, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t54e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t54e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t54e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 55
      call load_topology(55, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t55e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t55e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t55e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 56
      call load_topology(56, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t56e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t56e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t56e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 57
      call load_topology(57, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t57e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t57e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t57e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 58
      call load_topology(58, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t58e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t58e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t58e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 59
      call load_topology(59, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t59e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t59e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t59e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 60
      call load_topology(60, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t60e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t60e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t60e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 61
      call load_topology(61, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t61e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t61e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t61e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 62
      call load_topology(62, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t62e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t62e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t62e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 63
      call load_topology(63, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t63e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t63e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t63e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 64
      call load_topology(64, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t64e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t64e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t64e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 65
      call load_topology(65, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t65e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t65e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t65e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 66
      call load_topology(66, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t66e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t66e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t66e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 67
      call load_topology(67, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t67e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t67e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t67e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 68
      call load_topology(68, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t68e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t68e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t68e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 69
      call load_topology(69, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t69e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t69e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t69e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 70
      call load_topology(70, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t70e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t70e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t70e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 71
      call load_topology(71, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t71e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t71e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t71e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 72
      call load_topology(72, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t72e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t72e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t72e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 73
      call load_topology(73, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t73e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t73e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t73e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 74
      call load_topology(74, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t74e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t74e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t74e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 75
      call load_topology(75, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t75e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t75e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t75e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 76
      call load_topology(76, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t76e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t76e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t76e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 77
      call load_topology(77, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t77e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t77e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t77e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 78
      call load_topology(78, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t78e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t78e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t78e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 79
      call load_topology(79, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t79e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t79e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t79e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 80
      call load_topology(80, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t80e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t80e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t80e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 81
      call load_topology(81, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t81e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t81e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t81e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 82
      call load_topology(82, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t82e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t82e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t82e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 83
      call load_topology(83, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t83e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t83e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t83e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 84
      call load_topology(84, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t84e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t84e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t84e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 85
      call load_topology(85, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t85e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t85e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t85e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 86
      call load_topology(86, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t86e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t86e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t86e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 87
      call load_topology(87, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t87e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t87e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t87e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 88
      call load_topology(88, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t88e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t88e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t88e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
      ! Topology 89
      call load_topology(89, nleg, Vi, msq, rank)

      tot0(:) = 0.0_ki
      call samurai(numerator_t89e0,tot0,tot0r,&
      &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,my_ok)
      ok = ok .and. my_ok

      if (include_eps_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t89e1,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0(-1:0) = tot0(-1:0) + totx(-2:-1)
      end if

      if (include_eps2_terms) then
         totx(:) = 0.0_ki
         call samurai(numerator_t89e2,totx,tot0r,&
         &Vi(1:nleg,:),msq(1:nleg),nleg,rank,0,scale2,ok)
         ok = ok .and. my_ok
         tot0( 0) = tot0( 0) + totx(-2)
      end if

      samplitude(:) = samplitude(:) + 2.0_ki * real(tot0(:), ki)
   end function samplitude_topologies

   subroutine     load_topology(N, nleg, Vi, msq, rank)
      implicit none

      integer, intent(in) :: N
      integer, intent(out) :: nleg
      double precision, dimension(1:num_legs,4), intent(out) :: Vi
      double precision, dimension(1:num_legs), intent(out) :: msq
      integer, intent(out) :: rank

      select case(N)
      case(0)
         rank = 2
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(1)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(2)
         rank = 2
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(3)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(4)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(5)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(6)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(7)
         rank = 2
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(8)
         rank = 1
         nleg = 2
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = 0
      case(9)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(10)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(11)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(12)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(13)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k5((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(14)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(15)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(16)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(17)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(18)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(19)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(20)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(21)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(22)
         rank = 3
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(23)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(24)
         rank = 2
         nleg = 3
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = 0
      case(25)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(26)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(27)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(28)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(29)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(30)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(31)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(32)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(33)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(34)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(35)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(36)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(37)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(38)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(39)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(40)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(41)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(42)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(43)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(44)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(45)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(46)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(47)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(48)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(49)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(50)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k3((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(51)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(52)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(53)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k3((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(54)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(55)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(56)
         rank = 2
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k1((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(57)
         rank = 3
         nleg = 4
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = 0
      case(58)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(59)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(60)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(61)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k5((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(62)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(63)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(64)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(65)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k1((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(66)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(67)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(68)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(69)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k4((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k5((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(70)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(71)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(72)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(73)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = +k1((/2,3,4,1/))+k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(74)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = +k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k2((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(75)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(76)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(77)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(78)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(79)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))-k2((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(80)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = -k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(81)
         rank = 3
         nleg = 5
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = 0
      case(82)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(83)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(84)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(85)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k5((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(86)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k6((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(87)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(88)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = -k1((/2,3,4,1/))+k3((/2,3,4,1/))+k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k6((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case(89)
         rank = 3
         nleg = 6
         msq(1) = (0)*(0)
         Vi(1,:) = -k1((/2,3,4,1/))
         msq(2) = (0)*(0)
         Vi(2,:) = -k1((/2,3,4,1/))+k5((/2,3,4,1/))
         msq(3) = (0)*(0)
         Vi(3,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))-k4((/2,3,4,1/))
         msq(4) = (0)*(0)
         Vi(4,:) = +k2((/2,3,4,1/))-k3((/2,3,4,1/))
         msq(5) = (0)*(0)
         Vi(5,:) = +k2((/2,3,4,1/))
         msq(6) = (0)*(0)
         Vi(6,:) = 0
      case default
         nleg = -1
         return
      end select
   end subroutine load_topology

   subroutine     load_diagram(N, nleg, Vi, msq, rank)
      implicit none

      integer, intent(in) :: N
      integer, intent(out) :: nleg
      double precision, dimension(1:num_legs,4), intent(out) :: Vi
      double precision, dimension(1:num_legs), intent(out) :: msq
      integer, intent(out) :: rank
      integer :: topo_rank

      select case(N)
      case(2)
         rank = 1
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(27)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(28)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(29)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(30)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(31)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(32)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(33)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(89)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(90)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(91)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(92)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(93)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(94)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(95)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(96)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(97)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(98)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(99)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(100)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(101)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(102)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(159)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(160)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(161)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(162)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(163)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(164)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(165)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(166)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(167)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(168)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(169)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(170)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(171)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(172)
         rank = 2
         call pinch_topology(0, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(178)
         rank = 1
         call pinch_topology(1, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(3)
         rank = 1
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(20)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(21)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(22)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(23)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(24)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(25)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(26)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(103)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(104)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(105)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(106)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(107)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(108)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(109)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(110)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(111)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(112)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(113)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(114)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(115)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(116)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(131)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(132)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(133)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(134)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(135)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(136)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(137)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(138)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(139)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(140)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(141)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(142)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(143)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(144)
         rank = 2
         call pinch_topology(2, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(174)
         rank = 1
         call pinch_topology(3, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(173)
         rank = 1
         call pinch_topology(4, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(176)
         rank = 1
         call pinch_topology(5, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(175)
         rank = 1
         call pinch_topology(6, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(1)
         rank = 1
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(34)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(35)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(36)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(37)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(38)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(39)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(40)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(117)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(118)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(119)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(120)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(121)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(122)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(123)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(124)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(125)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(126)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(127)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(128)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(129)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(130)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(145)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(146)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(147)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(148)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(149)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(150)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(151)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(152)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(153)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(154)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(155)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(156)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(157)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(158)
         rank = 2
         call pinch_topology(7, (/1, 2/), nleg, Vi, msq, topo_rank)
      case(177)
         rank = 1
         call pinch_topology(8, (/2, 1/), nleg, Vi, msq, topo_rank)
      case(75)
         rank = 2
         call pinch_topology(9, (/1, 3, 2/), nleg, Vi, msq, topo_rank)
      case(76)
         rank = 2
         call pinch_topology(9, (/1, 3, 2/), nleg, Vi, msq, topo_rank)
      case(81)
         rank = 2
         call pinch_topology(10, (/1, 3, 2/), nleg, Vi, msq, topo_rank)
      case(82)
         rank = 2
         call pinch_topology(10, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(79)
         rank = 2
         call pinch_topology(11, (/1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(80)
         rank = 2
         call pinch_topology(11, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(6)
         rank = 1
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(63)
         rank = 2
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(64)
         rank = 2
         call pinch_topology(12, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(239)
         rank = 2
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(240)
         rank = 2
         call pinch_topology(12, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(241)
         rank = 2
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(242)
         rank = 2
         call pinch_topology(12, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(247)
         rank = 2
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(248)
         rank = 2
         call pinch_topology(12, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(249)
         rank = 2
         call pinch_topology(12, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(250)
         rank = 2
         call pinch_topology(12, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(4)
         rank = 1
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(59)
         rank = 2
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(60)
         rank = 2
         call pinch_topology(13, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(227)
         rank = 2
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(228)
         rank = 2
         call pinch_topology(13, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(229)
         rank = 2
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(230)
         rank = 2
         call pinch_topology(13, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(235)
         rank = 2
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(236)
         rank = 2
         call pinch_topology(13, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(237)
         rank = 2
         call pinch_topology(13, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(238)
         rank = 2
         call pinch_topology(13, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(83)
         rank = 2
         call pinch_topology(14, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(84)
         rank = 2
         call pinch_topology(14, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(5)
         rank = 1
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(61)
         rank = 2
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(62)
         rank = 2
         call pinch_topology(15, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(231)
         rank = 2
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(232)
         rank = 2
         call pinch_topology(15, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(233)
         rank = 2
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(234)
         rank = 2
         call pinch_topology(15, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(243)
         rank = 2
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(244)
         rank = 2
         call pinch_topology(15, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(245)
         rank = 2
         call pinch_topology(15, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(246)
         rank = 2
         call pinch_topology(15, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(77)
         rank = 2
         call pinch_topology(16, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(78)
         rank = 2
         call pinch_topology(16, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(67)
         rank = 2
         call pinch_topology(17, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(68)
         rank = 2
         call pinch_topology(17, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(87)
         rank = 2
         call pinch_topology(18, (/1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(88)
         rank = 2
         call pinch_topology(18, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(85)
         rank = 2
         call pinch_topology(19, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(86)
         rank = 2
         call pinch_topology(19, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(65)
         rank = 2
         call pinch_topology(20, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(66)
         rank = 2
         call pinch_topology(20, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(71)
         rank = 2
         call pinch_topology(21, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(72)
         rank = 2
         call pinch_topology(21, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(7)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(8)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(9)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(10)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(11)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(12)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(13)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(14)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(15)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(16)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(17)
         rank = 3
         call pinch_topology(22, (/2, 3, 1/), nleg, Vi, msq, topo_rank)
      case(18)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(19)
         rank = 3
         call pinch_topology(22, (/3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(69)
         rank = 2
         call pinch_topology(23, (/2, 1, 3/), nleg, Vi, msq, topo_rank)
      case(70)
         rank = 2
         call pinch_topology(23, (/1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(73)
         rank = 2
         call pinch_topology(24, (/1, 3, 2/), nleg, Vi, msq, topo_rank)
      case(74)
         rank = 2
         call pinch_topology(24, (/3, 1, 2/), nleg, Vi, msq, topo_rank)
      case(212)
         rank = 2
         call pinch_topology(25, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(207)
         rank = 2
         call pinch_topology(26, (/3, 4, 1, 2/), nleg, Vi, msq, topo_rank)
      case(226)
         rank = 2
         call pinch_topology(27, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(217)
         rank = 2
         call pinch_topology(28, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(221)
         rank = 2
         call pinch_topology(29, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(209)
         rank = 2
         call pinch_topology(30, (/3, 4, 1, 2/), nleg, Vi, msq, topo_rank)
      case(45)
         rank = 3
         call pinch_topology(31, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(46)
         rank = 3
         call pinch_topology(31, (/2, 3, 4, 1/), nleg, Vi, msq, topo_rank)
      case(214)
         rank = 2
         call pinch_topology(32, (/3, 4, 1, 2/), nleg, Vi, msq, topo_rank)
      case(208)
         rank = 2
         call pinch_topology(33, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(57)
         rank = 3
         call pinch_topology(34, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(58)
         rank = 3
         call pinch_topology(34, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(219)
         rank = 2
         call pinch_topology(35, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(210)
         rank = 2
         call pinch_topology(36, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(203)
         rank = 2
         call pinch_topology(37, (/1, 2, 3, 4/), nleg, Vi, msq, topo_rank)
      case(216)
         rank = 2
         call pinch_topology(38, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(224)
         rank = 2
         call pinch_topology(39, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(205)
         rank = 2
         call pinch_topology(40, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(225)
         rank = 2
         call pinch_topology(41, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(213)
         rank = 2
         call pinch_topology(42, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(53)
         rank = 3
         call pinch_topology(43, (/3, 4, 1, 2/), nleg, Vi, msq, topo_rank)
      case(54)
         rank = 3
         call pinch_topology(43, (/1, 2, 3, 4/), nleg, Vi, msq, topo_rank)
      case(211)
         rank = 2
         call pinch_topology(44, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(55)
         rank = 3
         call pinch_topology(45, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(56)
         rank = 3
         call pinch_topology(45, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(47)
         rank = 3
         call pinch_topology(46, (/2, 3, 4, 1/), nleg, Vi, msq, topo_rank)
      case(48)
         rank = 3
         call pinch_topology(46, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(220)
         rank = 2
         call pinch_topology(47, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(218)
         rank = 2
         call pinch_topology(48, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(223)
         rank = 2
         call pinch_topology(49, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(204)
         rank = 2
         call pinch_topology(50, (/1, 2, 3, 4/), nleg, Vi, msq, topo_rank)
      case(51)
         rank = 3
         call pinch_topology(51, (/3, 2, 1, 4/), nleg, Vi, msq, topo_rank)
      case(52)
         rank = 3
         call pinch_topology(51, (/1, 4, 3, 2/), nleg, Vi, msq, topo_rank)
      case(41)
         rank = 3
         call pinch_topology(52, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(42)
         rank = 3
         call pinch_topology(52, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(206)
         rank = 2
         call pinch_topology(53, (/1, 4, 3, 2/), nleg, Vi, msq, topo_rank)
      case(43)
         rank = 3
         call pinch_topology(54, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(44)
         rank = 3
         call pinch_topology(54, (/4, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(215)
         rank = 2
         call pinch_topology(55, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(222)
         rank = 2
         call pinch_topology(56, (/3, 4, 1, 2/), nleg, Vi, msq, topo_rank)
      case(49)
         rank = 3
         call pinch_topology(57, (/2, 1, 4, 3/), nleg, Vi, msq, topo_rank)
      case(50)
         rank = 3
         call pinch_topology(57, (/4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(181)
         rank = 3
         call pinch_topology(58, (/3, 2, 1, 5, 4/), nleg, Vi, msq, topo_rank)
      case(194)
         rank = 3
         call pinch_topology(59, (/2, 1, 5, 4, 3/), nleg, Vi, msq, topo_rank)
      case(197)
         rank = 3
         call pinch_topology(60, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(179)
         rank = 3
         call pinch_topology(61, (/3, 2, 1, 5, 4/), nleg, Vi, msq, topo_rank)
      case(189)
         rank = 3
         call pinch_topology(62, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(192)
         rank = 3
         call pinch_topology(63, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(184)
         rank = 3
         call pinch_topology(64, (/5, 1, 2, 3, 4/), nleg, Vi, msq, topo_rank)
      case(198)
         rank = 3
         call pinch_topology(65, (/3, 4, 5, 1, 2/), nleg, Vi, msq, topo_rank)
      case(190)
         rank = 3
         call pinch_topology(66, (/3, 4, 5, 1, 2/), nleg, Vi, msq, topo_rank)
      case(183)
         rank = 3
         call pinch_topology(67, (/5, 1, 2, 3, 4/), nleg, Vi, msq, topo_rank)
      case(185)
         rank = 3
         call pinch_topology(68, (/3, 2, 1, 5, 4/), nleg, Vi, msq, topo_rank)
      case(180)
         rank = 3
         call pinch_topology(69, (/3, 4, 5, 1, 2/), nleg, Vi, msq, topo_rank)
      case(193)
         rank = 3
         call pinch_topology(70, (/2, 3, 4, 5, 1/), nleg, Vi, msq, topo_rank)
      case(199)
         rank = 3
         call pinch_topology(71, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(188)
         rank = 3
         call pinch_topology(72, (/5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(186)
         rank = 3
         call pinch_topology(73, (/3, 4, 5, 1, 2/), nleg, Vi, msq, topo_rank)
      case(202)
         rank = 3
         call pinch_topology(74, (/4, 5, 1, 2, 3/), nleg, Vi, msq, topo_rank)
      case(191)
         rank = 3
         call pinch_topology(75, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(196)
         rank = 3
         call pinch_topology(76, (/5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(187)
         rank = 3
         call pinch_topology(77, (/5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(200)
         rank = 3
         call pinch_topology(78, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(182)
         rank = 3
         call pinch_topology(79, (/1, 5, 4, 3, 2/), nleg, Vi, msq, topo_rank)
      case(201)
         rank = 3
         call pinch_topology(80, (/4, 3, 2, 1, 5/), nleg, Vi, msq, topo_rank)
      case(195)
         rank = 3
         call pinch_topology(81, (/5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(251)
         rank = 3
         call pinch_topology(82, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(256)
         rank = 3
         call pinch_topology(83, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(257)
         rank = 3
         call pinch_topology(84, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(253)
         rank = 3
         call pinch_topology(85, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(258)
         rank = 3
         call pinch_topology(86, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(254)
         rank = 3
         call pinch_topology(87, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(252)
         rank = 3
         call pinch_topology(88, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case(255)
         rank = 3
         call pinch_topology(89, (/6, 5, 4, 3, 2, 1/), nleg, Vi, msq, topo_rank)
      case default
         nleg = -1
         return
      end select
   end subroutine load_diagram

   subroutine     pinch_topology(N, indices, nleg, Vi, msq, rank)
      implicit none

      integer, intent(in) :: N
      integer, dimension(:), intent(in) :: indices
      integer, intent(out) :: nleg
      double precision, dimension(1:num_legs,4), intent(out) :: Vi
      double precision, dimension(1:num_legs), intent(out) :: msq
      integer, intent(out) :: rank

      double precision, dimension(num_legs,4) :: tmp_Vi
      double precision, dimension(num_legs) :: tmp_msq
      integer :: idx, i, tmp_nleg, hi, lo

      hi = ubound(indices,1)
      lo = lbound(indices,1)

      call load_topology(N, tmp_nleg, tmp_Vi, tmp_msq, rank)

      if (tmp_nleg < hi - lo + 1) then
         nleg = -1
         return
      end if

      i = 0
      do idx = lbound(indices,1), ubound(indices,1)
         i = i + 1
         Vi(i,:) = tmp_Vi(indices(idx),:)
         msq(i) = tmp_msq(indices(idx))
      end do

      nleg = hi - lo + 1
   end subroutine pinch_topology

   function numerator_d2e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram2(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d2e0
   function numerator_d2e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram2(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d2e1
   function numerator_d2e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram2(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d2e2
   function numerator_d27e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram27(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d27e0
   function numerator_d27e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram27(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d27e1
   function numerator_d27e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram27(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d27e2
   function numerator_d28e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram28(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d28e0
   function numerator_d28e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram28(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d28e1
   function numerator_d28e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram28(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d28e2
   function numerator_d29e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram29(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d29e0
   function numerator_d29e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram29(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d29e1
   function numerator_d29e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram29(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d29e2
   function numerator_d30e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram30(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d30e0
   function numerator_d30e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram30(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d30e1
   function numerator_d30e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram30(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d30e2
   function numerator_d31e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram31(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d31e0
   function numerator_d31e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram31(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d31e1
   function numerator_d31e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram31(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d31e2
   function numerator_d32e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram32(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d32e0
   function numerator_d32e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram32(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d32e1
   function numerator_d32e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram32(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d32e2
   function numerator_d33e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram33(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d33e0
   function numerator_d33e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram33(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d33e1
   function numerator_d33e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram33(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d33e2
   function numerator_d89e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram89(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d89e0
   function numerator_d89e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram89(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d89e1
   function numerator_d89e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram89(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d89e2
   function numerator_d90e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram90(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d90e0
   function numerator_d90e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram90(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d90e1
   function numerator_d90e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram90(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d90e2
   function numerator_d91e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram91(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d91e0
   function numerator_d91e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram91(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d91e1
   function numerator_d91e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram91(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d91e2
   function numerator_d92e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram92(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d92e0
   function numerator_d92e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram92(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d92e1
   function numerator_d92e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram92(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d92e2
   function numerator_d93e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram93(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d93e0
   function numerator_d93e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram93(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d93e1
   function numerator_d93e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram93(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d93e2
   function numerator_d94e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram94(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d94e0
   function numerator_d94e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram94(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d94e1
   function numerator_d94e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram94(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d94e2
   function numerator_d95e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram95(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d95e0
   function numerator_d95e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram95(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d95e1
   function numerator_d95e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram95(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d95e2
   function numerator_d96e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram96(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d96e0
   function numerator_d96e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram96(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d96e1
   function numerator_d96e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram96(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d96e2
   function numerator_d97e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram97(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d97e0
   function numerator_d97e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram97(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d97e1
   function numerator_d97e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram97(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d97e2
   function numerator_d98e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram98(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d98e0
   function numerator_d98e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram98(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d98e1
   function numerator_d98e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram98(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d98e2
   function numerator_d99e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram99(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d99e0
   function numerator_d99e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram99(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d99e1
   function numerator_d99e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram99(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d99e2
   function numerator_d100e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram100(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d100e0
   function numerator_d100e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram100(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d100e1
   function numerator_d100e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram100(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d100e2
   function numerator_d101e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram101(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d101e0
   function numerator_d101e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram101(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d101e1
   function numerator_d101e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram101(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d101e2
   function numerator_d102e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram102(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d102e0
   function numerator_d102e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram102(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d102e1
   function numerator_d102e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram102(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d102e2
   function numerator_d159e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram159(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d159e0
   function numerator_d159e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram159(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d159e1
   function numerator_d159e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram159(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d159e2
   function numerator_d160e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram160(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d160e0
   function numerator_d160e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram160(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d160e1
   function numerator_d160e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram160(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d160e2
   function numerator_d161e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram161(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d161e0
   function numerator_d161e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram161(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d161e1
   function numerator_d161e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram161(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d161e2
   function numerator_d162e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram162(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d162e0
   function numerator_d162e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram162(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d162e1
   function numerator_d162e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram162(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d162e2
   function numerator_d163e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram163(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d163e0
   function numerator_d163e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram163(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d163e1
   function numerator_d163e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram163(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d163e2
   function numerator_d164e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram164(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d164e0
   function numerator_d164e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram164(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d164e1
   function numerator_d164e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram164(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d164e2
   function numerator_d165e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram165(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d165e0
   function numerator_d165e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram165(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d165e1
   function numerator_d165e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram165(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d165e2
   function numerator_d166e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram166(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d166e0
   function numerator_d166e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram166(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d166e1
   function numerator_d166e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram166(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d166e2
   function numerator_d167e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram167(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d167e0
   function numerator_d167e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram167(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d167e1
   function numerator_d167e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram167(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d167e2
   function numerator_d168e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram168(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d168e0
   function numerator_d168e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram168(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d168e1
   function numerator_d168e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram168(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d168e2
   function numerator_d169e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram169(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d169e0
   function numerator_d169e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram169(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d169e1
   function numerator_d169e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram169(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d169e2
   function numerator_d170e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram170(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d170e0
   function numerator_d170e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram170(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d170e1
   function numerator_d170e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram170(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d170e2
   function numerator_d171e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram171(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d171e0
   function numerator_d171e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram171(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d171e1
   function numerator_d171e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram171(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d171e2
   function numerator_d172e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram172(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d172e0
   function numerator_d172e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram172(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d172e1
   function numerator_d172e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(0, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram172(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d172e2
   function numerator_d178e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(1, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram178(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d178e0
   function numerator_d178e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(1, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram178(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d178e1
   function numerator_d178e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(1, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram178(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d178e2
   function numerator_d3e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram3(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d3e0
   function numerator_d3e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram3(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d3e1
   function numerator_d3e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram3(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d3e2
   function numerator_d20e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram20(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d20e0
   function numerator_d20e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram20(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d20e1
   function numerator_d20e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram20(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d20e2
   function numerator_d21e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram21(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d21e0
   function numerator_d21e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram21(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d21e1
   function numerator_d21e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram21(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d21e2
   function numerator_d22e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram22(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d22e0
   function numerator_d22e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram22(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d22e1
   function numerator_d22e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram22(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d22e2
   function numerator_d23e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram23(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d23e0
   function numerator_d23e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram23(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d23e1
   function numerator_d23e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram23(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d23e2
   function numerator_d24e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram24(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d24e0
   function numerator_d24e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram24(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d24e1
   function numerator_d24e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram24(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d24e2
   function numerator_d25e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram25(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d25e0
   function numerator_d25e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram25(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d25e1
   function numerator_d25e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram25(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d25e2
   function numerator_d26e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram26(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d26e0
   function numerator_d26e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram26(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d26e1
   function numerator_d26e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram26(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d26e2
   function numerator_d103e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram103(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d103e0
   function numerator_d103e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram103(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d103e1
   function numerator_d103e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram103(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d103e2
   function numerator_d104e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram104(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d104e0
   function numerator_d104e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram104(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d104e1
   function numerator_d104e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram104(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d104e2
   function numerator_d105e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram105(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d105e0
   function numerator_d105e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram105(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d105e1
   function numerator_d105e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram105(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d105e2
   function numerator_d106e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram106(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d106e0
   function numerator_d106e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram106(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d106e1
   function numerator_d106e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram106(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d106e2
   function numerator_d107e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram107(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d107e0
   function numerator_d107e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram107(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d107e1
   function numerator_d107e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram107(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d107e2
   function numerator_d108e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram108(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d108e0
   function numerator_d108e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram108(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d108e1
   function numerator_d108e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram108(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d108e2
   function numerator_d109e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram109(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d109e0
   function numerator_d109e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram109(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d109e1
   function numerator_d109e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram109(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d109e2
   function numerator_d110e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram110(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d110e0
   function numerator_d110e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram110(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d110e1
   function numerator_d110e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram110(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d110e2
   function numerator_d111e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram111(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d111e0
   function numerator_d111e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram111(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d111e1
   function numerator_d111e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram111(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d111e2
   function numerator_d112e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram112(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d112e0
   function numerator_d112e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram112(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d112e1
   function numerator_d112e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram112(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d112e2
   function numerator_d113e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram113(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d113e0
   function numerator_d113e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram113(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d113e1
   function numerator_d113e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram113(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d113e2
   function numerator_d114e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram114(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d114e0
   function numerator_d114e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram114(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d114e1
   function numerator_d114e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram114(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d114e2
   function numerator_d115e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram115(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d115e0
   function numerator_d115e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram115(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d115e1
   function numerator_d115e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram115(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d115e2
   function numerator_d116e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram116(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d116e0
   function numerator_d116e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram116(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d116e1
   function numerator_d116e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram116(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d116e2
   function numerator_d131e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram131(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d131e0
   function numerator_d131e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram131(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d131e1
   function numerator_d131e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram131(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d131e2
   function numerator_d132e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram132(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d132e0
   function numerator_d132e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram132(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d132e1
   function numerator_d132e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram132(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d132e2
   function numerator_d133e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram133(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d133e0
   function numerator_d133e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram133(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d133e1
   function numerator_d133e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram133(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d133e2
   function numerator_d134e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram134(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d134e0
   function numerator_d134e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram134(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d134e1
   function numerator_d134e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram134(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d134e2
   function numerator_d135e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram135(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d135e0
   function numerator_d135e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram135(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d135e1
   function numerator_d135e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram135(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d135e2
   function numerator_d136e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram136(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d136e0
   function numerator_d136e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram136(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d136e1
   function numerator_d136e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram136(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d136e2
   function numerator_d137e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram137(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d137e0
   function numerator_d137e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram137(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d137e1
   function numerator_d137e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram137(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d137e2
   function numerator_d138e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram138(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d138e0
   function numerator_d138e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram138(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d138e1
   function numerator_d138e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram138(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d138e2
   function numerator_d139e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram139(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d139e0
   function numerator_d139e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram139(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d139e1
   function numerator_d139e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram139(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d139e2
   function numerator_d140e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram140(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d140e0
   function numerator_d140e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram140(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d140e1
   function numerator_d140e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram140(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d140e2
   function numerator_d141e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram141(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d141e0
   function numerator_d141e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram141(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d141e1
   function numerator_d141e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram141(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d141e2
   function numerator_d142e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram142(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d142e0
   function numerator_d142e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram142(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d142e1
   function numerator_d142e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram142(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d142e2
   function numerator_d143e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram143(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d143e0
   function numerator_d143e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram143(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d143e1
   function numerator_d143e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram143(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d143e2
   function numerator_d144e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram144(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d144e0
   function numerator_d144e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram144(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d144e1
   function numerator_d144e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(2, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram144(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d144e2
   function numerator_d174e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(3, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram174(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d174e0
   function numerator_d174e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(3, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram174(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d174e1
   function numerator_d174e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(3, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram174(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d174e2
   function numerator_d173e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(4, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram173(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d173e0
   function numerator_d173e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(4, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram173(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d173e1
   function numerator_d173e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(4, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram173(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d173e2
   function numerator_d176e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(5, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram176(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d176e0
   function numerator_d176e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(5, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram176(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d176e1
   function numerator_d176e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(5, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram176(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d176e2
   function numerator_d175e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(6, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram175(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d175e0
   function numerator_d175e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(6, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram175(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d175e1
   function numerator_d175e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(6, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram175(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d175e2
   function numerator_d1e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram1(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d1e0
   function numerator_d1e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram1(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d1e1
   function numerator_d1e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram1(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d1e2
   function numerator_d34e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram34(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d34e0
   function numerator_d34e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram34(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d34e1
   function numerator_d34e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram34(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d34e2
   function numerator_d35e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram35(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d35e0
   function numerator_d35e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram35(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d35e1
   function numerator_d35e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram35(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d35e2
   function numerator_d36e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram36(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d36e0
   function numerator_d36e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram36(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d36e1
   function numerator_d36e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram36(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d36e2
   function numerator_d37e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram37(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d37e0
   function numerator_d37e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram37(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d37e1
   function numerator_d37e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram37(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d37e2
   function numerator_d38e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram38(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d38e0
   function numerator_d38e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram38(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d38e1
   function numerator_d38e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram38(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d38e2
   function numerator_d39e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram39(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d39e0
   function numerator_d39e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram39(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d39e1
   function numerator_d39e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram39(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d39e2
   function numerator_d40e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram40(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d40e0
   function numerator_d40e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram40(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d40e1
   function numerator_d40e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram40(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d40e2
   function numerator_d117e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram117(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d117e0
   function numerator_d117e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram117(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d117e1
   function numerator_d117e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram117(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d117e2
   function numerator_d118e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram118(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d118e0
   function numerator_d118e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram118(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d118e1
   function numerator_d118e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram118(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d118e2
   function numerator_d119e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram119(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d119e0
   function numerator_d119e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram119(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d119e1
   function numerator_d119e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram119(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d119e2
   function numerator_d120e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram120(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d120e0
   function numerator_d120e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram120(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d120e1
   function numerator_d120e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram120(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d120e2
   function numerator_d121e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram121(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d121e0
   function numerator_d121e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram121(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d121e1
   function numerator_d121e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram121(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d121e2
   function numerator_d122e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram122(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d122e0
   function numerator_d122e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram122(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d122e1
   function numerator_d122e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram122(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d122e2
   function numerator_d123e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram123(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d123e0
   function numerator_d123e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram123(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d123e1
   function numerator_d123e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram123(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d123e2
   function numerator_d124e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram124(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d124e0
   function numerator_d124e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram124(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d124e1
   function numerator_d124e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram124(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d124e2
   function numerator_d125e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram125(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d125e0
   function numerator_d125e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram125(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d125e1
   function numerator_d125e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram125(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d125e2
   function numerator_d126e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram126(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d126e0
   function numerator_d126e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram126(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d126e1
   function numerator_d126e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram126(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d126e2
   function numerator_d127e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram127(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d127e0
   function numerator_d127e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram127(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d127e1
   function numerator_d127e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram127(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d127e2
   function numerator_d128e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram128(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d128e0
   function numerator_d128e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram128(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d128e1
   function numerator_d128e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram128(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d128e2
   function numerator_d129e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram129(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d129e0
   function numerator_d129e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram129(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d129e1
   function numerator_d129e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram129(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d129e2
   function numerator_d130e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram130(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d130e0
   function numerator_d130e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram130(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d130e1
   function numerator_d130e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram130(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d130e2
   function numerator_d145e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram145(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d145e0
   function numerator_d145e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram145(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d145e1
   function numerator_d145e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram145(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d145e2
   function numerator_d146e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram146(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d146e0
   function numerator_d146e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram146(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d146e1
   function numerator_d146e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram146(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d146e2
   function numerator_d147e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram147(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d147e0
   function numerator_d147e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram147(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d147e1
   function numerator_d147e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram147(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d147e2
   function numerator_d148e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram148(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d148e0
   function numerator_d148e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram148(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d148e1
   function numerator_d148e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram148(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d148e2
   function numerator_d149e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram149(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d149e0
   function numerator_d149e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram149(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d149e1
   function numerator_d149e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram149(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d149e2
   function numerator_d150e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram150(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d150e0
   function numerator_d150e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram150(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d150e1
   function numerator_d150e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram150(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d150e2
   function numerator_d151e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram151(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d151e0
   function numerator_d151e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram151(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d151e1
   function numerator_d151e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram151(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d151e2
   function numerator_d152e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram152(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d152e0
   function numerator_d152e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram152(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d152e1
   function numerator_d152e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram152(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d152e2
   function numerator_d153e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram153(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d153e0
   function numerator_d153e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram153(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d153e1
   function numerator_d153e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram153(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d153e2
   function numerator_d154e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram154(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d154e0
   function numerator_d154e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram154(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d154e1
   function numerator_d154e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram154(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d154e2
   function numerator_d155e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram155(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d155e0
   function numerator_d155e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram155(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d155e1
   function numerator_d155e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram155(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d155e2
   function numerator_d156e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram156(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d156e0
   function numerator_d156e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram156(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d156e1
   function numerator_d156e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram156(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d156e2
   function numerator_d157e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram157(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d157e0
   function numerator_d157e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram157(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d157e1
   function numerator_d157e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram157(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d157e2
   function numerator_d158e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram158(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d158e0
   function numerator_d158e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram158(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d158e1
   function numerator_d158e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(7, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram158(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d158e2
   function numerator_d177e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(8, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram177(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d177e0
   function numerator_d177e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(8, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram177(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d177e1
   function numerator_d177e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(8, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram177(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d177e2
   function numerator_d75e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram75(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d75e0
   function numerator_d75e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram75(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d75e1
   function numerator_d75e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram75(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d75e2
   function numerator_d76e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram76(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d76e0
   function numerator_d76e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram76(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d76e1
   function numerator_d76e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(9, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram76(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d76e2
   function numerator_d81e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram81(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d81e0
   function numerator_d81e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram81(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d81e1
   function numerator_d81e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram81(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d81e2
   function numerator_d82e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram82(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d82e0
   function numerator_d82e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram82(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d82e1
   function numerator_d82e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(10, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram82(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d82e2
   function numerator_d79e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram79(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d79e0
   function numerator_d79e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram79(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d79e1
   function numerator_d79e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram79(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d79e2
   function numerator_d80e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram80(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d80e0
   function numerator_d80e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram80(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d80e1
   function numerator_d80e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(11, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram80(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d80e2
   function numerator_d6e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram6(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d6e0
   function numerator_d6e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram6(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d6e1
   function numerator_d6e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram6(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d6e2
   function numerator_d63e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram63(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d63e0
   function numerator_d63e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram63(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d63e1
   function numerator_d63e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram63(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d63e2
   function numerator_d64e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram64(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d64e0
   function numerator_d64e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram64(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d64e1
   function numerator_d64e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram64(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d64e2
   function numerator_d239e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram239(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d239e0
   function numerator_d239e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram239(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d239e1
   function numerator_d239e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram239(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d239e2
   function numerator_d240e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram240(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d240e0
   function numerator_d240e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram240(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d240e1
   function numerator_d240e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram240(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d240e2
   function numerator_d241e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram241(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d241e0
   function numerator_d241e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram241(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d241e1
   function numerator_d241e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram241(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d241e2
   function numerator_d242e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram242(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d242e0
   function numerator_d242e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram242(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d242e1
   function numerator_d242e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram242(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d242e2
   function numerator_d247e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram247(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d247e0
   function numerator_d247e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram247(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d247e1
   function numerator_d247e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram247(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d247e2
   function numerator_d248e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram248(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d248e0
   function numerator_d248e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram248(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d248e1
   function numerator_d248e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram248(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d248e2
   function numerator_d249e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram249(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d249e0
   function numerator_d249e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram249(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d249e1
   function numerator_d249e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram249(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d249e2
   function numerator_d250e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram250(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d250e0
   function numerator_d250e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram250(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d250e1
   function numerator_d250e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(12, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram250(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d250e2
   function numerator_d4e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram4(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d4e0
   function numerator_d4e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram4(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d4e1
   function numerator_d4e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram4(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d4e2
   function numerator_d59e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram59(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d59e0
   function numerator_d59e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram59(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d59e1
   function numerator_d59e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram59(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d59e2
   function numerator_d60e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram60(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d60e0
   function numerator_d60e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram60(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d60e1
   function numerator_d60e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram60(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d60e2
   function numerator_d227e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram227(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d227e0
   function numerator_d227e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram227(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d227e1
   function numerator_d227e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram227(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d227e2
   function numerator_d228e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram228(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d228e0
   function numerator_d228e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram228(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d228e1
   function numerator_d228e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram228(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d228e2
   function numerator_d229e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram229(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d229e0
   function numerator_d229e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram229(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d229e1
   function numerator_d229e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram229(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d229e2
   function numerator_d230e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram230(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d230e0
   function numerator_d230e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram230(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d230e1
   function numerator_d230e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram230(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d230e2
   function numerator_d235e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram235(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d235e0
   function numerator_d235e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram235(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d235e1
   function numerator_d235e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram235(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d235e2
   function numerator_d236e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram236(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d236e0
   function numerator_d236e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram236(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d236e1
   function numerator_d236e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram236(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d236e2
   function numerator_d237e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram237(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d237e0
   function numerator_d237e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram237(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d237e1
   function numerator_d237e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram237(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d237e2
   function numerator_d238e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram238(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d238e0
   function numerator_d238e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram238(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d238e1
   function numerator_d238e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(13, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram238(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d238e2
   function numerator_d83e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram83(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d83e0
   function numerator_d83e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram83(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d83e1
   function numerator_d83e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram83(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d83e2
   function numerator_d84e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram84(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d84e0
   function numerator_d84e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram84(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d84e1
   function numerator_d84e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(14, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram84(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d84e2
   function numerator_d5e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram5(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d5e0
   function numerator_d5e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram5(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d5e1
   function numerator_d5e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram5(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d5e2
   function numerator_d61e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram61(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d61e0
   function numerator_d61e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram61(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d61e1
   function numerator_d61e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram61(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d61e2
   function numerator_d62e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram62(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d62e0
   function numerator_d62e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram62(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d62e1
   function numerator_d62e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram62(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d62e2
   function numerator_d231e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram231(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d231e0
   function numerator_d231e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram231(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d231e1
   function numerator_d231e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram231(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d231e2
   function numerator_d232e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram232(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d232e0
   function numerator_d232e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram232(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d232e1
   function numerator_d232e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram232(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d232e2
   function numerator_d233e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram233(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d233e0
   function numerator_d233e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram233(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d233e1
   function numerator_d233e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram233(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d233e2
   function numerator_d234e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram234(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d234e0
   function numerator_d234e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram234(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d234e1
   function numerator_d234e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram234(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d234e2
   function numerator_d243e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram243(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d243e0
   function numerator_d243e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram243(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d243e1
   function numerator_d243e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram243(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d243e2
   function numerator_d244e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram244(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d244e0
   function numerator_d244e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram244(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d244e1
   function numerator_d244e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram244(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d244e2
   function numerator_d245e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram245(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d245e0
   function numerator_d245e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram245(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d245e1
   function numerator_d245e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram245(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d245e2
   function numerator_d246e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram246(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d246e0
   function numerator_d246e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram246(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d246e1
   function numerator_d246e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(15, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram246(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d246e2
   function numerator_d77e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram77(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d77e0
   function numerator_d77e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram77(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d77e1
   function numerator_d77e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram77(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d77e2
   function numerator_d78e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram78(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d78e0
   function numerator_d78e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram78(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d78e1
   function numerator_d78e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(16, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram78(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d78e2
   function numerator_d67e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram67(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d67e0
   function numerator_d67e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram67(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d67e1
   function numerator_d67e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram67(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d67e2
   function numerator_d68e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram68(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d68e0
   function numerator_d68e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram68(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d68e1
   function numerator_d68e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(17, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram68(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d68e2
   function numerator_d87e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram87(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d87e0
   function numerator_d87e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram87(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d87e1
   function numerator_d87e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram87(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d87e2
   function numerator_d88e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram88(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d88e0
   function numerator_d88e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram88(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d88e1
   function numerator_d88e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(18, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram88(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d88e2
   function numerator_d85e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram85(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d85e0
   function numerator_d85e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram85(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d85e1
   function numerator_d85e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram85(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d85e2
   function numerator_d86e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram86(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d86e0
   function numerator_d86e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram86(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d86e1
   function numerator_d86e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(19, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram86(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d86e2
   function numerator_d65e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram65(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d65e0
   function numerator_d65e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram65(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d65e1
   function numerator_d65e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram65(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d65e2
   function numerator_d66e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram66(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d66e0
   function numerator_d66e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram66(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d66e1
   function numerator_d66e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(20, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram66(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d66e2
   function numerator_d71e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram71(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d71e0
   function numerator_d71e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram71(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d71e1
   function numerator_d71e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram71(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d71e2
   function numerator_d72e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram72(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d72e0
   function numerator_d72e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram72(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d72e1
   function numerator_d72e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(21, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram72(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d72e2
   function numerator_d7e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram7(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d7e0
   function numerator_d7e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram7(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d7e1
   function numerator_d7e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram7(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d7e2
   function numerator_d8e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram8(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d8e0
   function numerator_d8e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram8(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d8e1
   function numerator_d8e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram8(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d8e2
   function numerator_d9e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram9(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d9e0
   function numerator_d9e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram9(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d9e1
   function numerator_d9e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram9(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d9e2
   function numerator_d10e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram10(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d10e0
   function numerator_d10e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram10(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d10e1
   function numerator_d10e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram10(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d10e2
   function numerator_d11e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram11(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d11e0
   function numerator_d11e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram11(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d11e1
   function numerator_d11e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram11(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d11e2
   function numerator_d12e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram12(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d12e0
   function numerator_d12e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram12(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d12e1
   function numerator_d12e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram12(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d12e2
   function numerator_d13e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram13(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d13e0
   function numerator_d13e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram13(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d13e1
   function numerator_d13e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram13(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d13e2
   function numerator_d14e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram14(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d14e0
   function numerator_d14e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram14(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d14e1
   function numerator_d14e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram14(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d14e2
   function numerator_d15e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram15(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d15e0
   function numerator_d15e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram15(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d15e1
   function numerator_d15e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram15(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d15e2
   function numerator_d16e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram16(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d16e0
   function numerator_d16e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram16(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d16e1
   function numerator_d16e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram16(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d16e2
   function numerator_d17e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram17(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d17e0
   function numerator_d17e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram17(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d17e1
   function numerator_d17e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram17(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d17e2
   function numerator_d18e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram18(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d18e0
   function numerator_d18e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram18(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d18e1
   function numerator_d18e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram18(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d18e2
   function numerator_d19e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram19(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d19e0
   function numerator_d19e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram19(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d19e1
   function numerator_d19e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(22, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram19(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d19e2
   function numerator_d69e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram69(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d69e0
   function numerator_d69e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram69(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d69e1
   function numerator_d69e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram69(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d69e2
   function numerator_d70e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram70(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d70e0
   function numerator_d70e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram70(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d70e1
   function numerator_d70e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(23, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram70(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d70e2
   function numerator_d73e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram73(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d73e0
   function numerator_d73e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram73(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d73e1
   function numerator_d73e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram73(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d73e2
   function numerator_d74e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram74(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d74e0
   function numerator_d74e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram74(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d74e1
   function numerator_d74e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(24, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram74(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d74e2
   function numerator_d212e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(25, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram212(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d212e0
   function numerator_d212e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(25, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram212(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d212e1
   function numerator_d212e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(25, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram212(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d212e2
   function numerator_d207e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(26, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram207(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d207e0
   function numerator_d207e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(26, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram207(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d207e1
   function numerator_d207e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(26, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram207(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d207e2
   function numerator_d226e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(27, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram226(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d226e0
   function numerator_d226e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(27, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram226(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d226e1
   function numerator_d226e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(27, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram226(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d226e2
   function numerator_d217e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(28, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram217(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d217e0
   function numerator_d217e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(28, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram217(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d217e1
   function numerator_d217e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(28, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram217(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d217e2
   function numerator_d221e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(29, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram221(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d221e0
   function numerator_d221e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(29, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram221(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d221e1
   function numerator_d221e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(29, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram221(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d221e2
   function numerator_d209e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(30, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram209(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d209e0
   function numerator_d209e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(30, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram209(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d209e1
   function numerator_d209e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(30, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram209(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d209e2
   function numerator_d45e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram45(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d45e0
   function numerator_d45e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram45(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d45e1
   function numerator_d45e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram45(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d45e2
   function numerator_d46e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram46(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d46e0
   function numerator_d46e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram46(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d46e1
   function numerator_d46e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(31, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram46(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d46e2
   function numerator_d214e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(32, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram214(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d214e0
   function numerator_d214e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(32, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram214(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d214e1
   function numerator_d214e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(32, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram214(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d214e2
   function numerator_d208e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(33, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram208(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d208e0
   function numerator_d208e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(33, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram208(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d208e1
   function numerator_d208e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(33, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram208(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d208e2
   function numerator_d57e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram57(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d57e0
   function numerator_d57e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram57(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d57e1
   function numerator_d57e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram57(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d57e2
   function numerator_d58e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram58(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d58e0
   function numerator_d58e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram58(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d58e1
   function numerator_d58e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(34, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram58(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d58e2
   function numerator_d219e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(35, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram219(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d219e0
   function numerator_d219e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(35, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram219(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d219e1
   function numerator_d219e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(35, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram219(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d219e2
   function numerator_d210e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(36, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram210(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d210e0
   function numerator_d210e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(36, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram210(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d210e1
   function numerator_d210e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(36, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram210(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d210e2
   function numerator_d203e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(37, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram203(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d203e0
   function numerator_d203e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(37, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram203(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d203e1
   function numerator_d203e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(37, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram203(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d203e2
   function numerator_d216e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(38, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram216(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d216e0
   function numerator_d216e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(38, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram216(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d216e1
   function numerator_d216e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(38, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram216(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d216e2
   function numerator_d224e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(39, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram224(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d224e0
   function numerator_d224e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(39, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram224(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d224e1
   function numerator_d224e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(39, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram224(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d224e2
   function numerator_d205e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(40, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram205(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d205e0
   function numerator_d205e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(40, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram205(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d205e1
   function numerator_d205e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(40, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram205(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d205e2
   function numerator_d225e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(41, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram225(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d225e0
   function numerator_d225e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(41, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram225(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d225e1
   function numerator_d225e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(41, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram225(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d225e2
   function numerator_d213e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(42, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram213(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d213e0
   function numerator_d213e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(42, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram213(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d213e1
   function numerator_d213e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(42, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram213(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d213e2
   function numerator_d53e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram53(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d53e0
   function numerator_d53e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram53(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d53e1
   function numerator_d53e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram53(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d53e2
   function numerator_d54e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram54(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d54e0
   function numerator_d54e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram54(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d54e1
   function numerator_d54e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(43, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram54(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d54e2
   function numerator_d211e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(44, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram211(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d211e0
   function numerator_d211e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(44, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram211(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d211e1
   function numerator_d211e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(44, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram211(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d211e2
   function numerator_d55e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram55(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d55e0
   function numerator_d55e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram55(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d55e1
   function numerator_d55e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram55(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d55e2
   function numerator_d56e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram56(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d56e0
   function numerator_d56e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram56(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d56e1
   function numerator_d56e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(45, nleg, Vi, msq, rank)
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram56(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d56e2
   function numerator_d47e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram47(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d47e0
   function numerator_d47e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram47(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d47e1
   function numerator_d47e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram47(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d47e2
   function numerator_d48e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram48(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d48e0
   function numerator_d48e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram48(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d48e1
   function numerator_d48e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(46, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram48(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d48e2
   function numerator_d220e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(47, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram220(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d220e0
   function numerator_d220e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(47, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram220(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d220e1
   function numerator_d220e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(47, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram220(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d220e2
   function numerator_d218e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(48, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram218(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d218e0
   function numerator_d218e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(48, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram218(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d218e1
   function numerator_d218e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(48, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram218(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d218e2
   function numerator_d223e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(49, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram223(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d223e0
   function numerator_d223e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(49, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram223(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d223e1
   function numerator_d223e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(49, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram223(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d223e2
   function numerator_d204e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(50, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram204(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d204e0
   function numerator_d204e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(50, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram204(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d204e1
   function numerator_d204e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(50, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram204(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d204e2
   function numerator_d51e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram51(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d51e0
   function numerator_d51e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram51(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d51e1
   function numerator_d51e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram51(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d51e2
   function numerator_d52e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram52(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d52e0
   function numerator_d52e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram52(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d52e1
   function numerator_d52e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(51, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram52(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d52e2
   function numerator_d41e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram41(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d41e0
   function numerator_d41e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram41(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d41e1
   function numerator_d41e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram41(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d41e2
   function numerator_d42e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram42(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d42e0
   function numerator_d42e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram42(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d42e1
   function numerator_d42e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(52, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram42(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d42e2
   function numerator_d206e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(53, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram206(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d206e0
   function numerator_d206e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(53, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram206(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d206e1
   function numerator_d206e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(53, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram206(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d206e2
   function numerator_d43e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram43(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d43e0
   function numerator_d43e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram43(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d43e1
   function numerator_d43e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram43(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d43e2
   function numerator_d44e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram44(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d44e0
   function numerator_d44e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram44(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d44e1
   function numerator_d44e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(54, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram44(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d44e2
   function numerator_d215e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(55, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram215(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d215e0
   function numerator_d215e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(55, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram215(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d215e1
   function numerator_d215e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(55, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram215(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d215e2
   function numerator_d222e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(56, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram222(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d222e0
   function numerator_d222e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(56, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram222(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d222e1
   function numerator_d222e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(56, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram222(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d222e2
   function numerator_d49e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram49(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d49e0
   function numerator_d49e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram49(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d49e1
   function numerator_d49e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram49(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d49e2
   function numerator_d50e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram50(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d50e0
   function numerator_d50e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram50(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d50e1
   function numerator_d50e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(57, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram50(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d50e2
   function numerator_d181e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(58, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram181(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d181e0
   function numerator_d181e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(58, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram181(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d181e1
   function numerator_d181e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(58, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram181(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d181e2
   function numerator_d194e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(59, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram194(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d194e0
   function numerator_d194e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(59, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram194(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d194e1
   function numerator_d194e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(59, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram194(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d194e2
   function numerator_d197e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(60, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram197(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d197e0
   function numerator_d197e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(60, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram197(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d197e1
   function numerator_d197e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(60, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram197(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d197e2
   function numerator_d179e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(61, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram179(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d179e0
   function numerator_d179e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(61, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram179(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d179e1
   function numerator_d179e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(61, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram179(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d179e2
   function numerator_d189e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(62, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram189(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d189e0
   function numerator_d189e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(62, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram189(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d189e1
   function numerator_d189e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(62, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram189(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d189e2
   function numerator_d192e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(63, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram192(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d192e0
   function numerator_d192e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(63, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram192(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d192e1
   function numerator_d192e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(63, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram192(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d192e2
   function numerator_d184e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(64, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram184(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d184e0
   function numerator_d184e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(64, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram184(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d184e1
   function numerator_d184e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(64, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram184(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d184e2
   function numerator_d198e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(65, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram198(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d198e0
   function numerator_d198e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(65, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram198(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d198e1
   function numerator_d198e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(65, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram198(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d198e2
   function numerator_d190e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(66, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram190(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d190e0
   function numerator_d190e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(66, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram190(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d190e1
   function numerator_d190e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(66, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram190(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d190e2
   function numerator_d183e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(67, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram183(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d183e0
   function numerator_d183e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(67, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram183(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d183e1
   function numerator_d183e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(67, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram183(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d183e2
   function numerator_d185e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(68, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram185(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d185e0
   function numerator_d185e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(68, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram185(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d185e1
   function numerator_d185e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(68, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(4, 4))
      Q(2) = (Q_ext(1) + Vi(4, 1))
      Q(3) = (Q_ext(2) + Vi(4, 2))
      Q(4) = (Q_ext(3) + Vi(4, 3))

      res(:) = 0.0_ki
      call diagram185(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d185e2
   function numerator_d180e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(69, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram180(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d180e0
   function numerator_d180e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(69, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram180(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d180e1
   function numerator_d180e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(69, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram180(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d180e2
   function numerator_d193e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(70, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram193(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d193e0
   function numerator_d193e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(70, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram193(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d193e1
   function numerator_d193e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(70, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram193(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d193e2
   function numerator_d199e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(71, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram199(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d199e0
   function numerator_d199e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(71, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram199(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d199e1
   function numerator_d199e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(71, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram199(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d199e2
   function numerator_d188e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(72, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram188(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d188e0
   function numerator_d188e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(72, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram188(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d188e1
   function numerator_d188e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(72, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram188(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d188e2
   function numerator_d186e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(73, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram186(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d186e0
   function numerator_d186e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(73, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram186(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d186e1
   function numerator_d186e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(73, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram186(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d186e2
   function numerator_d202e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(74, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram202(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d202e0
   function numerator_d202e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(74, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram202(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d202e1
   function numerator_d202e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(74, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(3, 4))
      Q(2) = (Q_ext(1) + Vi(3, 1))
      Q(3) = (Q_ext(2) + Vi(3, 2))
      Q(4) = (Q_ext(3) + Vi(3, 3))

      res(:) = 0.0_ki
      call diagram202(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d202e2
   function numerator_d191e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(75, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram191(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d191e0
   function numerator_d191e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(75, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram191(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d191e1
   function numerator_d191e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(75, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram191(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d191e2
   function numerator_d196e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(76, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram196(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d196e0
   function numerator_d196e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(76, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram196(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d196e1
   function numerator_d196e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(76, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram196(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d196e2
   function numerator_d187e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(77, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram187(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d187e0
   function numerator_d187e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(77, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram187(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d187e1
   function numerator_d187e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(77, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram187(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d187e2
   function numerator_d200e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(78, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram200(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d200e0
   function numerator_d200e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(78, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram200(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d200e1
   function numerator_d200e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(78, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram200(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d200e2
   function numerator_d182e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(79, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram182(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d182e0
   function numerator_d182e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(79, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram182(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d182e1
   function numerator_d182e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(79, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(2, 4))
      Q(2) = (Q_ext(1) + Vi(2, 1))
      Q(3) = (Q_ext(2) + Vi(2, 2))
      Q(4) = (Q_ext(3) + Vi(2, 3))

      res(:) = 0.0_ki
      call diagram182(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d182e2
   function numerator_d201e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(80, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram201(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d201e0
   function numerator_d201e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(80, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram201(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d201e1
   function numerator_d201e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(80, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(5, 4))
      Q(2) = (Q_ext(1) + Vi(5, 1))
      Q(3) = (Q_ext(2) + Vi(5, 2))
      Q(4) = (Q_ext(3) + Vi(5, 3))

      res(:) = 0.0_ki
      call diagram201(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d201e2
   function numerator_d195e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(81, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram195(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d195e0
   function numerator_d195e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(81, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram195(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d195e1
   function numerator_d195e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(81, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram195(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d195e2
   function numerator_d251e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(82, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram251(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d251e0
   function numerator_d251e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(82, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram251(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d251e1
   function numerator_d251e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(82, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram251(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d251e2
   function numerator_d256e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(83, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram256(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d256e0
   function numerator_d256e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(83, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram256(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d256e1
   function numerator_d256e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(83, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram256(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d256e2
   function numerator_d257e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(84, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram257(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d257e0
   function numerator_d257e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(84, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram257(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d257e1
   function numerator_d257e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(84, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram257(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d257e2
   function numerator_d253e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(85, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram253(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d253e0
   function numerator_d253e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(85, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram253(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d253e1
   function numerator_d253e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(85, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram253(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d253e2
   function numerator_d258e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(86, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram258(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d258e0
   function numerator_d258e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(86, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram258(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d258e1
   function numerator_d258e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(86, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram258(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d258e2
   function numerator_d254e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(87, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram254(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d254e0
   function numerator_d254e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(87, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram254(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d254e1
   function numerator_d254e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(87, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram254(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d254e2
   function numerator_d252e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(88, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram252(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d252e0
   function numerator_d252e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(88, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram252(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d252e1
   function numerator_d252e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(88, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram252(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d252e2
   function numerator_d255e0(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(89, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram255(Q, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_d255e0
   function numerator_d255e1(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(89, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram255(Q, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_d255e1
   function numerator_d255e2(ncut,Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      ! The Q that goes into the diagram
      complex(ki), dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(num_legs,4) :: Vi
      double precision, dimension(num_legs) :: msq

      ! In order to compute the correct Q we need to calculate
      ! a shift such that r_n becomes 0
      call load_topology(89, nleg, Vi, msq, rank)
      Q(1) = (Q_ext(4) + Vi(1, 4))
      Q(2) = (Q_ext(1) + Vi(1, 1))
      Q(3) = (Q_ext(2) + Vi(1, 2))
      Q(4) = (Q_ext(3) + Vi(1, 3))

      res(:) = 0.0_ki
      call diagram255(Q, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_d255e2

   subroutine     topology0(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(0, nleg, Vi, msq, rank)
      !---#[ Diagram 2 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram2(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 2 :
      !---#[ Diagram 27 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram27(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 27 :
      !---#[ Diagram 28 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram28(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 28 :
      !---#[ Diagram 29 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram29(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 29 :
      !---#[ Diagram 30 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram30(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 30 :
      !---#[ Diagram 31 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram31(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 31 :
      !---#[ Diagram 32 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram32(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 32 :
      !---#[ Diagram 33 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram33(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 33 :
      !---#[ Diagram 89 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram89(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 89 :
      !---#[ Diagram 90 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram90(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 90 :
      !---#[ Diagram 91 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram91(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 91 :
      !---#[ Diagram 92 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram92(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 92 :
      !---#[ Diagram 93 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram93(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 93 :
      !---#[ Diagram 94 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram94(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 94 :
      !---#[ Diagram 95 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram95(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 95 :
      !---#[ Diagram 96 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram96(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 96 :
      !---#[ Diagram 97 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram97(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 97 :
      !---#[ Diagram 98 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram98(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 98 :
      !---#[ Diagram 99 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram99(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 99 :
      !---#[ Diagram 100 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram100(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 100 :
      !---#[ Diagram 101 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram101(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 101 :
      !---#[ Diagram 102 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram102(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 102 :
      !---#[ Diagram 159 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram159(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 159 :
      !---#[ Diagram 160 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram160(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 160 :
      !---#[ Diagram 161 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram161(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 161 :
      !---#[ Diagram 162 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram162(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 162 :
      !---#[ Diagram 163 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram163(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 163 :
      !---#[ Diagram 164 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram164(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 164 :
      !---#[ Diagram 165 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram165(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 165 :
      !---#[ Diagram 166 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram166(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 166 :
      !---#[ Diagram 167 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram167(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 167 :
      !---#[ Diagram 168 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram168(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 168 :
      !---#[ Diagram 169 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram169(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 169 :
      !---#[ Diagram 170 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram170(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 170 :
      !---#[ Diagram 171 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram171(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 171 :
      !---#[ Diagram 172 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram172(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 172 :
   end subroutine topology0
   function numerator_t0e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology0(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t0e0
   function numerator_t0e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology0(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t0e1
   function numerator_t0e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology0(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t0e2
   subroutine     topology1(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(1, nleg, Vi, msq, rank)
      !---#[ Diagram 178 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram178(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 178 :
   end subroutine topology1
   function numerator_t1e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology1(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t1e0
   function numerator_t1e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology1(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t1e1
   function numerator_t1e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology1(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t1e2
   subroutine     topology2(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(2, nleg, Vi, msq, rank)
      !---#[ Diagram 3 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram3(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 3 :
      !---#[ Diagram 20 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram20(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 20 :
      !---#[ Diagram 21 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram21(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 21 :
      !---#[ Diagram 22 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram22(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 22 :
      !---#[ Diagram 23 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram23(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 23 :
      !---#[ Diagram 24 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram24(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 24 :
      !---#[ Diagram 25 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram25(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 25 :
      !---#[ Diagram 26 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram26(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 26 :
      !---#[ Diagram 103 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram103(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 103 :
      !---#[ Diagram 104 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram104(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 104 :
      !---#[ Diagram 105 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram105(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 105 :
      !---#[ Diagram 106 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram106(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 106 :
      !---#[ Diagram 107 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram107(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 107 :
      !---#[ Diagram 108 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram108(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 108 :
      !---#[ Diagram 109 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram109(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 109 :
      !---#[ Diagram 110 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram110(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 110 :
      !---#[ Diagram 111 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram111(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 111 :
      !---#[ Diagram 112 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram112(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 112 :
      !---#[ Diagram 113 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram113(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 113 :
      !---#[ Diagram 114 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram114(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 114 :
      !---#[ Diagram 115 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram115(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 115 :
      !---#[ Diagram 116 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram116(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 116 :
      !---#[ Diagram 131 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram131(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 131 :
      !---#[ Diagram 132 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram132(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 132 :
      !---#[ Diagram 133 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram133(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 133 :
      !---#[ Diagram 134 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram134(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 134 :
      !---#[ Diagram 135 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram135(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 135 :
      !---#[ Diagram 136 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram136(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 136 :
      !---#[ Diagram 137 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram137(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 137 :
      !---#[ Diagram 138 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram138(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 138 :
      !---#[ Diagram 139 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram139(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 139 :
      !---#[ Diagram 140 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram140(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 140 :
      !---#[ Diagram 141 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram141(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 141 :
      !---#[ Diagram 142 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram142(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 142 :
      !---#[ Diagram 143 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram143(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 143 :
      !---#[ Diagram 144 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram144(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 144 :
   end subroutine topology2
   function numerator_t2e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology2(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t2e0
   function numerator_t2e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology2(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t2e1
   function numerator_t2e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology2(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t2e2
   subroutine     topology3(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(3, nleg, Vi, msq, rank)
      !---#[ Diagram 174 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram174(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 174 :
   end subroutine topology3
   function numerator_t3e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology3(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t3e0
   function numerator_t3e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology3(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t3e1
   function numerator_t3e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology3(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t3e2
   subroutine     topology4(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(4, nleg, Vi, msq, rank)
      !---#[ Diagram 173 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram173(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 173 :
   end subroutine topology4
   function numerator_t4e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology4(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t4e0
   function numerator_t4e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology4(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t4e1
   function numerator_t4e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology4(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t4e2
   subroutine     topology5(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(5, nleg, Vi, msq, rank)
      !---#[ Diagram 176 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram176(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 176 :
   end subroutine topology5
   function numerator_t5e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology5(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t5e0
   function numerator_t5e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology5(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t5e1
   function numerator_t5e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology5(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t5e2
   subroutine     topology6(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(6, nleg, Vi, msq, rank)
      !---#[ Diagram 175 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram175(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 175 :
   end subroutine topology6
   function numerator_t6e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology6(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t6e0
   function numerator_t6e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology6(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t6e1
   function numerator_t6e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology6(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t6e2
   subroutine     topology7(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(7, nleg, Vi, msq, rank)
      !---#[ Diagram 1 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram1(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 1 :
      !---#[ Diagram 34 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram34(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 34 :
      !---#[ Diagram 35 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram35(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 35 :
      !---#[ Diagram 36 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram36(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 36 :
      !---#[ Diagram 37 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram37(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 37 :
      !---#[ Diagram 38 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram38(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 38 :
      !---#[ Diagram 39 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram39(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 39 :
      !---#[ Diagram 40 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram40(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 40 :
      !---#[ Diagram 117 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram117(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 117 :
      !---#[ Diagram 118 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram118(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 118 :
      !---#[ Diagram 119 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram119(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 119 :
      !---#[ Diagram 120 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram120(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 120 :
      !---#[ Diagram 121 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram121(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 121 :
      !---#[ Diagram 122 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram122(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 122 :
      !---#[ Diagram 123 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram123(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 123 :
      !---#[ Diagram 124 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram124(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 124 :
      !---#[ Diagram 125 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram125(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 125 :
      !---#[ Diagram 126 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram126(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 126 :
      !---#[ Diagram 127 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram127(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 127 :
      !---#[ Diagram 128 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram128(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 128 :
      !---#[ Diagram 129 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram129(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 129 :
      !---#[ Diagram 130 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram130(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 130 :
      !---#[ Diagram 145 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram145(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 145 :
      !---#[ Diagram 146 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram146(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 146 :
      !---#[ Diagram 147 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram147(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 147 :
      !---#[ Diagram 148 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram148(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 148 :
      !---#[ Diagram 149 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram149(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 149 :
      !---#[ Diagram 150 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram150(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 150 :
      !---#[ Diagram 151 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram151(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 151 :
      !---#[ Diagram 152 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram152(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 152 :
      !---#[ Diagram 153 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram153(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 153 :
      !---#[ Diagram 154 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram154(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 154 :
      !---#[ Diagram 155 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram155(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 155 :
      !---#[ Diagram 156 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram156(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 156 :
      !---#[ Diagram 157 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram157(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 157 :
      !---#[ Diagram 158 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram158(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 158 :
   end subroutine topology7
   function numerator_t7e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology7(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t7e0
   function numerator_t7e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology7(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t7e1
   function numerator_t7e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology7(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t7e2
   subroutine     topology8(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(8, nleg, Vi, msq, rank)
      !---#[ Diagram 177 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram177(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 177 :
   end subroutine topology8
   function numerator_t8e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology8(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t8e0
   function numerator_t8e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology8(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t8e1
   function numerator_t8e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology8(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t8e2
   subroutine     topology9(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(9, nleg, Vi, msq, rank)
      !---#[ Diagram 75 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram75(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 75 :
      !---#[ Diagram 76 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram76(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 76 :
   end subroutine topology9
   function numerator_t9e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology9(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t9e0
   function numerator_t9e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology9(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t9e1
   function numerator_t9e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology9(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t9e2
   subroutine     topology10(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(10, nleg, Vi, msq, rank)
      !---#[ Diagram 81 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram81(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 81 :
      !---#[ Diagram 82 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram82(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 82 :
   end subroutine topology10
   function numerator_t10e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology10(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t10e0
   function numerator_t10e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology10(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t10e1
   function numerator_t10e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology10(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t10e2
   subroutine     topology11(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(11, nleg, Vi, msq, rank)
      !---#[ Diagram 79 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram79(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 79 :
      !---#[ Diagram 80 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))
      call diagram80(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 80 :
   end subroutine topology11
   function numerator_t11e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology11(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t11e0
   function numerator_t11e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology11(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t11e1
   function numerator_t11e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology11(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t11e2
   subroutine     topology12(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(12, nleg, Vi, msq, rank)
      !---#[ Diagram 6 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram6(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 6 :
      !---#[ Diagram 63 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram63(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 63 :
      !---#[ Diagram 64 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram64(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 64 :
      !---#[ Diagram 239 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram239(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 239 :
      !---#[ Diagram 240 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram240(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 240 :
      !---#[ Diagram 241 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram241(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 241 :
      !---#[ Diagram 242 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram242(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 242 :
      !---#[ Diagram 247 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram247(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 247 :
      !---#[ Diagram 248 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram248(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 248 :
      !---#[ Diagram 249 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram249(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 249 :
      !---#[ Diagram 250 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram250(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 250 :
   end subroutine topology12
   function numerator_t12e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology12(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t12e0
   function numerator_t12e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology12(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t12e1
   function numerator_t12e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology12(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t12e2
   subroutine     topology13(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(13, nleg, Vi, msq, rank)
      !---#[ Diagram 4 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram4(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 4 :
      !---#[ Diagram 59 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram59(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 59 :
      !---#[ Diagram 60 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram60(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 60 :
      !---#[ Diagram 227 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram227(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 227 :
      !---#[ Diagram 228 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram228(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 228 :
      !---#[ Diagram 229 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram229(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 229 :
      !---#[ Diagram 230 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram230(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 230 :
      !---#[ Diagram 235 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram235(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 235 :
      !---#[ Diagram 236 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram236(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 236 :
      !---#[ Diagram 237 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram237(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 237 :
      !---#[ Diagram 238 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram238(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 238 :
   end subroutine topology13
   function numerator_t13e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology13(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t13e0
   function numerator_t13e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology13(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t13e1
   function numerator_t13e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology13(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t13e2
   subroutine     topology14(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(14, nleg, Vi, msq, rank)
      !---#[ Diagram 83 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram83(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 83 :
      !---#[ Diagram 84 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram84(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 84 :
   end subroutine topology14
   function numerator_t14e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology14(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t14e0
   function numerator_t14e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology14(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t14e1
   function numerator_t14e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology14(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t14e2
   subroutine     topology15(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(15, nleg, Vi, msq, rank)
      !---#[ Diagram 5 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram5(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 5 :
      !---#[ Diagram 61 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram61(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 61 :
      !---#[ Diagram 62 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram62(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 62 :
      !---#[ Diagram 231 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram231(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 231 :
      !---#[ Diagram 232 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram232(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 232 :
      !---#[ Diagram 233 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram233(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 233 :
      !---#[ Diagram 234 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram234(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 234 :
      !---#[ Diagram 243 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram243(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 243 :
      !---#[ Diagram 244 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram244(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 244 :
      !---#[ Diagram 245 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram245(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 245 :
      !---#[ Diagram 246 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram246(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 246 :
   end subroutine topology15
   function numerator_t15e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology15(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t15e0
   function numerator_t15e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology15(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t15e1
   function numerator_t15e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology15(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t15e2
   subroutine     topology16(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(16, nleg, Vi, msq, rank)
      !---#[ Diagram 77 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram77(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 77 :
      !---#[ Diagram 78 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram78(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 78 :
   end subroutine topology16
   function numerator_t16e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology16(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t16e0
   function numerator_t16e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology16(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t16e1
   function numerator_t16e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology16(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t16e2
   subroutine     topology17(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(17, nleg, Vi, msq, rank)
      !---#[ Diagram 67 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram67(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 67 :
      !---#[ Diagram 68 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram68(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 68 :
   end subroutine topology17
   function numerator_t17e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology17(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t17e0
   function numerator_t17e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology17(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t17e1
   function numerator_t17e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology17(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t17e2
   subroutine     topology18(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(18, nleg, Vi, msq, rank)
      !---#[ Diagram 87 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram87(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 87 :
      !---#[ Diagram 88 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))
      call diagram88(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 88 :
   end subroutine topology18
   function numerator_t18e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology18(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t18e0
   function numerator_t18e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology18(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t18e1
   function numerator_t18e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology18(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t18e2
   subroutine     topology19(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(19, nleg, Vi, msq, rank)
      !---#[ Diagram 85 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram85(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 85 :
      !---#[ Diagram 86 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram86(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 86 :
   end subroutine topology19
   function numerator_t19e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology19(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t19e0
   function numerator_t19e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology19(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t19e1
   function numerator_t19e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology19(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t19e2
   subroutine     topology20(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(20, nleg, Vi, msq, rank)
      !---#[ Diagram 65 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram65(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 65 :
      !---#[ Diagram 66 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram66(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 66 :
   end subroutine topology20
   function numerator_t20e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology20(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t20e0
   function numerator_t20e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology20(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t20e1
   function numerator_t20e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology20(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t20e2
   subroutine     topology21(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(21, nleg, Vi, msq, rank)
      !---#[ Diagram 71 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram71(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 71 :
      !---#[ Diagram 72 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram72(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 72 :
   end subroutine topology21
   function numerator_t21e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology21(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t21e0
   function numerator_t21e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology21(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t21e1
   function numerator_t21e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology21(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t21e2
   subroutine     topology22(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(22, nleg, Vi, msq, rank)
      !---#[ Diagram 7 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram7(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 7 :
      !---#[ Diagram 8 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram8(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 8 :
      !---#[ Diagram 9 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram9(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 9 :
      !---#[ Diagram 10 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram10(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 10 :
      !---#[ Diagram 11 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram11(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 11 :
      !---#[ Diagram 12 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram12(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 12 :
      !---#[ Diagram 13 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram13(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 13 :
      !---#[ Diagram 14 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram14(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 14 :
      !---#[ Diagram 15 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram15(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 15 :
      !---#[ Diagram 16 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram16(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 16 :
      !---#[ Diagram 17 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram17(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 17 :
      !---#[ Diagram 18 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram18(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 18 :
      !---#[ Diagram 19 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram19(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 19 :
   end subroutine topology22
   function numerator_t22e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology22(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t22e0
   function numerator_t22e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology22(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t22e1
   function numerator_t22e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology22(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t22e2
   subroutine     topology23(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(23, nleg, Vi, msq, rank)
      !---#[ Diagram 69 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram69(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 69 :
      !---#[ Diagram 70 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))
      call diagram70(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 70 :
   end subroutine topology23
   function numerator_t23e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology23(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t23e0
   function numerator_t23e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology23(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t23e1
   function numerator_t23e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology23(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t23e2
   subroutine     topology24(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(24, nleg, Vi, msq, rank)
      !---#[ Diagram 73 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram73(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 73 :
      !---#[ Diagram 74 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(2, 4))
      Q(2) = -(Q_ext(1) + Vi(2, 1))
      Q(3) = -(Q_ext(2) + Vi(2, 2))
      Q(4) = -(Q_ext(3) + Vi(2, 3))
      call diagram74(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 74 :
   end subroutine topology24
   function numerator_t24e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology24(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t24e0
   function numerator_t24e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology24(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t24e1
   function numerator_t24e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology24(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t24e2
   subroutine     topology25(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(25, nleg, Vi, msq, rank)
      !---#[ Diagram 212 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram212(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 212 :
   end subroutine topology25
   function numerator_t25e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology25(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t25e0
   function numerator_t25e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology25(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t25e1
   function numerator_t25e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology25(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t25e2
   subroutine     topology26(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(26, nleg, Vi, msq, rank)
      !---#[ Diagram 207 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram207(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 207 :
   end subroutine topology26
   function numerator_t26e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology26(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t26e0
   function numerator_t26e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology26(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t26e1
   function numerator_t26e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology26(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t26e2
   subroutine     topology27(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(27, nleg, Vi, msq, rank)
      !---#[ Diagram 226 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram226(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 226 :
   end subroutine topology27
   function numerator_t27e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology27(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t27e0
   function numerator_t27e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology27(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t27e1
   function numerator_t27e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology27(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t27e2
   subroutine     topology28(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(28, nleg, Vi, msq, rank)
      !---#[ Diagram 217 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram217(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 217 :
   end subroutine topology28
   function numerator_t28e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology28(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t28e0
   function numerator_t28e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology28(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t28e1
   function numerator_t28e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology28(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t28e2
   subroutine     topology29(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(29, nleg, Vi, msq, rank)
      !---#[ Diagram 221 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram221(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 221 :
   end subroutine topology29
   function numerator_t29e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology29(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t29e0
   function numerator_t29e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology29(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t29e1
   function numerator_t29e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology29(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t29e2
   subroutine     topology30(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(30, nleg, Vi, msq, rank)
      !---#[ Diagram 209 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram209(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 209 :
   end subroutine topology30
   function numerator_t30e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology30(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t30e0
   function numerator_t30e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology30(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t30e1
   function numerator_t30e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology30(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t30e2
   subroutine     topology31(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(31, nleg, Vi, msq, rank)
      !---#[ Diagram 45 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram45(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 45 :
      !---#[ Diagram 46 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(1, 4))
      Q(2) = -(Q_ext(1) + Vi(1, 1))
      Q(3) = -(Q_ext(2) + Vi(1, 2))
      Q(4) = -(Q_ext(3) + Vi(1, 3))
      call diagram46(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 46 :
   end subroutine topology31
   function numerator_t31e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology31(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t31e0
   function numerator_t31e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology31(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t31e1
   function numerator_t31e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology31(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t31e2
   subroutine     topology32(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(32, nleg, Vi, msq, rank)
      !---#[ Diagram 214 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram214(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 214 :
   end subroutine topology32
   function numerator_t32e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology32(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t32e0
   function numerator_t32e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology32(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t32e1
   function numerator_t32e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology32(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t32e2
   subroutine     topology33(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(33, nleg, Vi, msq, rank)
      !---#[ Diagram 208 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram208(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 208 :
   end subroutine topology33
   function numerator_t33e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology33(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t33e0
   function numerator_t33e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology33(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t33e1
   function numerator_t33e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology33(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t33e2
   subroutine     topology34(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(34, nleg, Vi, msq, rank)
      !---#[ Diagram 57 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram57(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 57 :
      !---#[ Diagram 58 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))
      call diagram58(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 58 :
   end subroutine topology34
   function numerator_t34e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology34(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t34e0
   function numerator_t34e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology34(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t34e1
   function numerator_t34e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology34(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t34e2
   subroutine     topology35(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(35, nleg, Vi, msq, rank)
      !---#[ Diagram 219 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram219(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 219 :
   end subroutine topology35
   function numerator_t35e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology35(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t35e0
   function numerator_t35e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology35(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t35e1
   function numerator_t35e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology35(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t35e2
   subroutine     topology36(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(36, nleg, Vi, msq, rank)
      !---#[ Diagram 210 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram210(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 210 :
   end subroutine topology36
   function numerator_t36e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology36(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t36e0
   function numerator_t36e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology36(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t36e1
   function numerator_t36e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology36(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t36e2
   subroutine     topology37(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(37, nleg, Vi, msq, rank)
      !---#[ Diagram 203 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram203(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 203 :
   end subroutine topology37
   function numerator_t37e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology37(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t37e0
   function numerator_t37e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology37(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t37e1
   function numerator_t37e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology37(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t37e2
   subroutine     topology38(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(38, nleg, Vi, msq, rank)
      !---#[ Diagram 216 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram216(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 216 :
   end subroutine topology38
   function numerator_t38e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology38(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t38e0
   function numerator_t38e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology38(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t38e1
   function numerator_t38e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology38(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t38e2
   subroutine     topology39(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(39, nleg, Vi, msq, rank)
      !---#[ Diagram 224 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram224(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 224 :
   end subroutine topology39
   function numerator_t39e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology39(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t39e0
   function numerator_t39e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology39(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t39e1
   function numerator_t39e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology39(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t39e2
   subroutine     topology40(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(40, nleg, Vi, msq, rank)
      !---#[ Diagram 205 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram205(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 205 :
   end subroutine topology40
   function numerator_t40e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology40(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t40e0
   function numerator_t40e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology40(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t40e1
   function numerator_t40e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology40(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t40e2
   subroutine     topology41(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(41, nleg, Vi, msq, rank)
      !---#[ Diagram 225 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram225(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 225 :
   end subroutine topology41
   function numerator_t41e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology41(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t41e0
   function numerator_t41e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology41(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t41e1
   function numerator_t41e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology41(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t41e2
   subroutine     topology42(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(42, nleg, Vi, msq, rank)
      !---#[ Diagram 213 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram213(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 213 :
   end subroutine topology42
   function numerator_t42e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology42(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t42e0
   function numerator_t42e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology42(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t42e1
   function numerator_t42e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology42(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t42e2
   subroutine     topology43(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(43, nleg, Vi, msq, rank)
      !---#[ Diagram 53 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram53(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 53 :
      !---#[ Diagram 54 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram54(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 54 :
   end subroutine topology43
   function numerator_t43e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology43(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t43e0
   function numerator_t43e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology43(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t43e1
   function numerator_t43e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology43(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t43e2
   subroutine     topology44(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(44, nleg, Vi, msq, rank)
      !---#[ Diagram 211 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram211(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 211 :
   end subroutine topology44
   function numerator_t44e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology44(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t44e0
   function numerator_t44e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology44(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t44e1
   function numerator_t44e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology44(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t44e2
   subroutine     topology45(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(45, nleg, Vi, msq, rank)
      !---#[ Diagram 55 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram55(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 55 :
      !---#[ Diagram 56 :
      acc(:) = 0.0d0
      Q(1) = -(Q_ext(4) + Vi(3, 4))
      Q(2) = -(Q_ext(1) + Vi(3, 1))
      Q(3) = -(Q_ext(2) + Vi(3, 2))
      Q(4) = -(Q_ext(3) + Vi(3, 3))
      call diagram56(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 56 :
   end subroutine topology45
   function numerator_t45e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology45(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t45e0
   function numerator_t45e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology45(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t45e1
   function numerator_t45e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology45(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t45e2
   subroutine     topology46(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(46, nleg, Vi, msq, rank)
      !---#[ Diagram 47 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram47(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 47 :
      !---#[ Diagram 48 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram48(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 48 :
   end subroutine topology46
   function numerator_t46e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology46(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t46e0
   function numerator_t46e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology46(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t46e1
   function numerator_t46e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology46(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t46e2
   subroutine     topology47(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(47, nleg, Vi, msq, rank)
      !---#[ Diagram 220 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram220(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 220 :
   end subroutine topology47
   function numerator_t47e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology47(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t47e0
   function numerator_t47e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology47(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t47e1
   function numerator_t47e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology47(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t47e2
   subroutine     topology48(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(48, nleg, Vi, msq, rank)
      !---#[ Diagram 218 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram218(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 218 :
   end subroutine topology48
   function numerator_t48e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology48(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t48e0
   function numerator_t48e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology48(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t48e1
   function numerator_t48e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology48(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t48e2
   subroutine     topology49(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(49, nleg, Vi, msq, rank)
      !---#[ Diagram 223 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram223(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 223 :
   end subroutine topology49
   function numerator_t49e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology49(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t49e0
   function numerator_t49e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology49(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t49e1
   function numerator_t49e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology49(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t49e2
   subroutine     topology50(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(50, nleg, Vi, msq, rank)
      !---#[ Diagram 204 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram204(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 204 :
   end subroutine topology50
   function numerator_t50e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology50(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t50e0
   function numerator_t50e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology50(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t50e1
   function numerator_t50e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology50(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t50e2
   subroutine     topology51(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(51, nleg, Vi, msq, rank)
      !---#[ Diagram 51 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram51(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 51 :
      !---#[ Diagram 52 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram52(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 52 :
   end subroutine topology51
   function numerator_t51e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology51(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t51e0
   function numerator_t51e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology51(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t51e1
   function numerator_t51e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology51(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t51e2
   subroutine     topology52(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(52, nleg, Vi, msq, rank)
      !---#[ Diagram 41 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram41(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 41 :
      !---#[ Diagram 42 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram42(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 42 :
   end subroutine topology52
   function numerator_t52e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology52(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t52e0
   function numerator_t52e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology52(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t52e1
   function numerator_t52e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology52(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t52e2
   subroutine     topology53(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(53, nleg, Vi, msq, rank)
      !---#[ Diagram 206 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram206(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 206 :
   end subroutine topology53
   function numerator_t53e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology53(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t53e0
   function numerator_t53e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology53(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t53e1
   function numerator_t53e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology53(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t53e2
   subroutine     topology54(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(54, nleg, Vi, msq, rank)
      !---#[ Diagram 43 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram43(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 43 :
      !---#[ Diagram 44 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram44(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 44 :
   end subroutine topology54
   function numerator_t54e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology54(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t54e0
   function numerator_t54e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology54(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t54e1
   function numerator_t54e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology54(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t54e2
   subroutine     topology55(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(55, nleg, Vi, msq, rank)
      !---#[ Diagram 215 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram215(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 215 :
   end subroutine topology55
   function numerator_t55e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology55(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t55e0
   function numerator_t55e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology55(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t55e1
   function numerator_t55e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology55(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t55e2
   subroutine     topology56(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(56, nleg, Vi, msq, rank)
      !---#[ Diagram 222 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram222(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 222 :
   end subroutine topology56
   function numerator_t56e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology56(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t56e0
   function numerator_t56e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology56(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t56e1
   function numerator_t56e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology56(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t56e2
   subroutine     topology57(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(57, nleg, Vi, msq, rank)
      !---#[ Diagram 49 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram49(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 49 :
      !---#[ Diagram 50 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram50(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 50 :
   end subroutine topology57
   function numerator_t57e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology57(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t57e0
   function numerator_t57e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology57(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t57e1
   function numerator_t57e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology57(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t57e2
   subroutine     topology58(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(58, nleg, Vi, msq, rank)
      !---#[ Diagram 181 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram181(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 181 :
   end subroutine topology58
   function numerator_t58e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology58(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t58e0
   function numerator_t58e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology58(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t58e1
   function numerator_t58e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology58(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t58e2
   subroutine     topology59(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(59, nleg, Vi, msq, rank)
      !---#[ Diagram 194 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram194(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 194 :
   end subroutine topology59
   function numerator_t59e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology59(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t59e0
   function numerator_t59e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology59(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t59e1
   function numerator_t59e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology59(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t59e2
   subroutine     topology60(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(60, nleg, Vi, msq, rank)
      !---#[ Diagram 197 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram197(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 197 :
   end subroutine topology60
   function numerator_t60e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology60(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t60e0
   function numerator_t60e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology60(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t60e1
   function numerator_t60e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology60(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t60e2
   subroutine     topology61(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(61, nleg, Vi, msq, rank)
      !---#[ Diagram 179 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram179(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 179 :
   end subroutine topology61
   function numerator_t61e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology61(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t61e0
   function numerator_t61e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology61(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t61e1
   function numerator_t61e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology61(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t61e2
   subroutine     topology62(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(62, nleg, Vi, msq, rank)
      !---#[ Diagram 189 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram189(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 189 :
   end subroutine topology62
   function numerator_t62e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology62(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t62e0
   function numerator_t62e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology62(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t62e1
   function numerator_t62e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology62(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t62e2
   subroutine     topology63(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(63, nleg, Vi, msq, rank)
      !---#[ Diagram 192 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram192(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 192 :
   end subroutine topology63
   function numerator_t63e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology63(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t63e0
   function numerator_t63e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology63(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t63e1
   function numerator_t63e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology63(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t63e2
   subroutine     topology64(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(64, nleg, Vi, msq, rank)
      !---#[ Diagram 184 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram184(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 184 :
   end subroutine topology64
   function numerator_t64e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology64(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t64e0
   function numerator_t64e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology64(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t64e1
   function numerator_t64e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology64(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t64e2
   subroutine     topology65(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(65, nleg, Vi, msq, rank)
      !---#[ Diagram 198 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram198(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 198 :
   end subroutine topology65
   function numerator_t65e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology65(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t65e0
   function numerator_t65e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology65(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t65e1
   function numerator_t65e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology65(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t65e2
   subroutine     topology66(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(66, nleg, Vi, msq, rank)
      !---#[ Diagram 190 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram190(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 190 :
   end subroutine topology66
   function numerator_t66e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology66(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t66e0
   function numerator_t66e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology66(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t66e1
   function numerator_t66e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology66(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t66e2
   subroutine     topology67(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(67, nleg, Vi, msq, rank)
      !---#[ Diagram 183 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram183(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 183 :
   end subroutine topology67
   function numerator_t67e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology67(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t67e0
   function numerator_t67e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology67(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t67e1
   function numerator_t67e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology67(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t67e2
   subroutine     topology68(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(68, nleg, Vi, msq, rank)
      !---#[ Diagram 185 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(4, 4))
      Q(2) = +(Q_ext(1) + Vi(4, 1))
      Q(3) = +(Q_ext(2) + Vi(4, 2))
      Q(4) = +(Q_ext(3) + Vi(4, 3))
      call diagram185(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 185 :
   end subroutine topology68
   function numerator_t68e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology68(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t68e0
   function numerator_t68e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology68(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t68e1
   function numerator_t68e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology68(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t68e2
   subroutine     topology69(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(69, nleg, Vi, msq, rank)
      !---#[ Diagram 180 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram180(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 180 :
   end subroutine topology69
   function numerator_t69e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology69(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t69e0
   function numerator_t69e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology69(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t69e1
   function numerator_t69e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology69(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t69e2
   subroutine     topology70(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(70, nleg, Vi, msq, rank)
      !---#[ Diagram 193 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram193(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 193 :
   end subroutine topology70
   function numerator_t70e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology70(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t70e0
   function numerator_t70e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology70(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t70e1
   function numerator_t70e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology70(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t70e2
   subroutine     topology71(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(71, nleg, Vi, msq, rank)
      !---#[ Diagram 199 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram199(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 199 :
   end subroutine topology71
   function numerator_t71e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology71(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t71e0
   function numerator_t71e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology71(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t71e1
   function numerator_t71e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology71(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t71e2
   subroutine     topology72(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(72, nleg, Vi, msq, rank)
      !---#[ Diagram 188 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram188(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 188 :
   end subroutine topology72
   function numerator_t72e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology72(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t72e0
   function numerator_t72e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology72(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t72e1
   function numerator_t72e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology72(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t72e2
   subroutine     topology73(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(73, nleg, Vi, msq, rank)
      !---#[ Diagram 186 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram186(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 186 :
   end subroutine topology73
   function numerator_t73e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology73(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t73e0
   function numerator_t73e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology73(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t73e1
   function numerator_t73e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology73(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t73e2
   subroutine     topology74(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(74, nleg, Vi, msq, rank)
      !---#[ Diagram 202 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(3, 4))
      Q(2) = +(Q_ext(1) + Vi(3, 1))
      Q(3) = +(Q_ext(2) + Vi(3, 2))
      Q(4) = +(Q_ext(3) + Vi(3, 3))
      call diagram202(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 202 :
   end subroutine topology74
   function numerator_t74e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology74(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t74e0
   function numerator_t74e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology74(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t74e1
   function numerator_t74e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology74(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t74e2
   subroutine     topology75(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(75, nleg, Vi, msq, rank)
      !---#[ Diagram 191 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram191(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 191 :
   end subroutine topology75
   function numerator_t75e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology75(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t75e0
   function numerator_t75e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology75(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t75e1
   function numerator_t75e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology75(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t75e2
   subroutine     topology76(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(76, nleg, Vi, msq, rank)
      !---#[ Diagram 196 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram196(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 196 :
   end subroutine topology76
   function numerator_t76e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology76(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t76e0
   function numerator_t76e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology76(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t76e1
   function numerator_t76e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology76(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t76e2
   subroutine     topology77(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(77, nleg, Vi, msq, rank)
      !---#[ Diagram 187 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram187(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 187 :
   end subroutine topology77
   function numerator_t77e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology77(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t77e0
   function numerator_t77e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology77(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t77e1
   function numerator_t77e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology77(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t77e2
   subroutine     topology78(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(78, nleg, Vi, msq, rank)
      !---#[ Diagram 200 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram200(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 200 :
   end subroutine topology78
   function numerator_t78e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology78(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t78e0
   function numerator_t78e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology78(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t78e1
   function numerator_t78e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology78(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t78e2
   subroutine     topology79(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(79, nleg, Vi, msq, rank)
      !---#[ Diagram 182 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(2, 4))
      Q(2) = +(Q_ext(1) + Vi(2, 1))
      Q(3) = +(Q_ext(2) + Vi(2, 2))
      Q(4) = +(Q_ext(3) + Vi(2, 3))
      call diagram182(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 182 :
   end subroutine topology79
   function numerator_t79e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology79(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t79e0
   function numerator_t79e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology79(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t79e1
   function numerator_t79e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology79(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t79e2
   subroutine     topology80(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(80, nleg, Vi, msq, rank)
      !---#[ Diagram 201 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(5, 4))
      Q(2) = +(Q_ext(1) + Vi(5, 1))
      Q(3) = +(Q_ext(2) + Vi(5, 2))
      Q(4) = +(Q_ext(3) + Vi(5, 3))
      call diagram201(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 201 :
   end subroutine topology80
   function numerator_t80e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology80(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t80e0
   function numerator_t80e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology80(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t80e1
   function numerator_t80e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology80(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t80e2
   subroutine     topology81(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(81, nleg, Vi, msq, rank)
      !---#[ Diagram 195 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram195(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 195 :
   end subroutine topology81
   function numerator_t81e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology81(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t81e0
   function numerator_t81e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology81(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t81e1
   function numerator_t81e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology81(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t81e2
   subroutine     topology82(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(82, nleg, Vi, msq, rank)
      !---#[ Diagram 251 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram251(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 251 :
   end subroutine topology82
   function numerator_t82e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology82(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t82e0
   function numerator_t82e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology82(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t82e1
   function numerator_t82e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology82(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t82e2
   subroutine     topology83(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(83, nleg, Vi, msq, rank)
      !---#[ Diagram 256 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram256(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 256 :
   end subroutine topology83
   function numerator_t83e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology83(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t83e0
   function numerator_t83e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology83(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t83e1
   function numerator_t83e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology83(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t83e2
   subroutine     topology84(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(84, nleg, Vi, msq, rank)
      !---#[ Diagram 257 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram257(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 257 :
   end subroutine topology84
   function numerator_t84e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology84(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t84e0
   function numerator_t84e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology84(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t84e1
   function numerator_t84e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology84(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t84e2
   subroutine     topology85(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(85, nleg, Vi, msq, rank)
      !---#[ Diagram 253 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram253(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 253 :
   end subroutine topology85
   function numerator_t85e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology85(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t85e0
   function numerator_t85e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology85(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t85e1
   function numerator_t85e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology85(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t85e2
   subroutine     topology86(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(86, nleg, Vi, msq, rank)
      !---#[ Diagram 258 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram258(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 258 :
   end subroutine topology86
   function numerator_t86e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology86(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t86e0
   function numerator_t86e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology86(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t86e1
   function numerator_t86e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology86(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t86e2
   subroutine     topology87(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(87, nleg, Vi, msq, rank)
      !---#[ Diagram 254 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram254(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 254 :
   end subroutine topology87
   function numerator_t87e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology87(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t87e0
   function numerator_t87e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology87(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t87e1
   function numerator_t87e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology87(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t87e2
   subroutine     topology88(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(88, nleg, Vi, msq, rank)
      !---#[ Diagram 252 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram252(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 252 :
   end subroutine topology88
   function numerator_t88e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology88(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t88e0
   function numerator_t88e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology88(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t88e1
   function numerator_t88e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology88(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t88e2
   subroutine     topology89(Q_ext, mu2, epspow, res)
      implicit none
      double complex, dimension(4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      integer, intent(in) :: epspow
      double complex, dimension(1:numcs), intent(inout) :: res

      double complex, dimension(1:numcs) :: acc

      double complex, dimension(4) :: Q
      integer :: nleg, rank
      double precision, dimension(1:num_legs,4) :: Vi
      double precision, dimension(1:num_legs) :: msq

      res(:) = 0.0d0
      call load_topology(89, nleg, Vi, msq, rank)
      !---#[ Diagram 255 :
      acc(:) = 0.0d0
      Q(1) = +(Q_ext(4) + Vi(1, 4))
      Q(2) = +(Q_ext(1) + Vi(1, 1))
      Q(3) = +(Q_ext(2) + Vi(1, 2))
      Q(4) = +(Q_ext(3) + Vi(1, 3))
      call diagram255(Q, mu2, epspow, acc)
      res(:) = res(:) + acc(:)
      !---#] Diagram 255 :
   end subroutine topology89
   function numerator_t89e0(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology89(Q_ext, mu2, 0, res)
      numerator = ccontract(res, amp0)
   end function numerator_t89e0
   function numerator_t89e1(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology89(Q_ext, mu2, 1, res)
      numerator = ccontract(res, amp0)
   end function numerator_t89e1
   function numerator_t89e2(ncut, Q_ext, mu2) result(numerator)
      implicit none

      integer, intent(in) :: ncut
      double complex, dimension(1:4), intent(in) :: Q_ext
      double complex, intent(in) :: mu2
      double complex :: numerator

      ! full result as expansion:
      complex(ki), dimension(1:numcs) :: res

      call topology89(Q_ext, mu2, 2, res)
      numerator = ccontract(res, amp0)
   end function numerator_t89e2

   pure function ccontract(color_vector1, color_vector2) result(amp)
      use uussbb_color, only: cmat => CC
      implicit none
      complex(ki), dimension(numcs), intent(in) :: color_vector1
      complex(ki), dimension(numcs), intent(in) :: color_vector2
      complex(ki) :: amp
      complex(ki), dimension(numcs) :: v1, v2

      if (use_perm) then
         v1 = matmul(cmat, color_vector1(perm))
      else
         v1 = matmul(cmat, color_vector1)
      end if
      v2 = conjg(color_vector2)
      amp = sum(v1(:) * v2(:))
   end function  ccontract
end module uussbb_diagramsh1l1
